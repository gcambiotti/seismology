
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>4. Fourier transform &#8212; Seismology</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. Discrete Fourier transform" href="C2_Discrete.html" />
    <link rel="prev" title="3. Harmonic oscillators" href="C0_Harmonic.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/gc_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Seismology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Setup
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="A0_Setup.html">
   1. Working with JupyterLab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="A1_Tutorial.html">
   2. Tutorial on Python
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Theory
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="C0_Harmonic.html">
   3. Harmonic oscillators
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4. Fourier transform
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="C2_Discrete.html">
   5. Discrete Fourier transform
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Laboratory
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="L0_Seismic_catalogs_and_networks.html">
   6. Seismic catalogs and networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="L1_Waveforms.html">
   7. Waveform processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="L2_Local_magnitude.html">
   8. Local magnitude
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="L3_Earthquake_localization.html">
   9. Earthquake localization
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Z0_Dirac.html">
   10. Dirac delta function
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Z1_Geographic_Maps.html">
   11. Geographic maps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Z2_Inverse_Theory.html">
   12. Inverse problem theory
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Libraries
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Z3_Libraries.html">
   13. Libraries
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   4.1. Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#properties-of-the-fourier-transform">
   4.2. Properties of the Fourier transform
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#shift-in-time">
     4.2.1. Shift in time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#derivatives">
     4.2.2. Derivatives
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convolution">
     4.2.3. Convolution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#real-functions">
     4.2.4. Real functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#application-to-the-harmonic-oscillator">
   4.3. Application to the harmonic oscillator
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#green-function">
     4.3.1. Green function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#response-function">
     4.3.2. Response function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#amplitude-factor-and-phase">
     4.3.3. Amplitude factor and phase
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sinusoidal-ground-motion">
     4.3.4. Sinusoidal ground motion
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Fourier transform</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   4.1. Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#properties-of-the-fourier-transform">
   4.2. Properties of the Fourier transform
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#shift-in-time">
     4.2.1. Shift in time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#derivatives">
     4.2.2. Derivatives
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convolution">
     4.2.3. Convolution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#real-functions">
     4.2.4. Real functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#application-to-the-harmonic-oscillator">
   4.3. Application to the harmonic oscillator
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#green-function">
     4.3.1. Green function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#response-function">
     4.3.2. Response function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#amplitude-factor-and-phase">
     4.3.3. Amplitude factor and phase
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sinusoidal-ground-motion">
     4.3.4. Sinusoidal ground motion
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="fourier-transform">
<span id="chap-f"></span><h1><span class="section-number">4. </span>Fourier transform<a class="headerlink" href="#fourier-transform" title="Permalink to this headline">#</a></h1>
<div class="contents local topic" id="sections">
<p class="topic-title">Sections</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#properties-of-the-fourier-transform" id="id2">Properties of the Fourier transform</a></p>
<ul>
<li><p><a class="reference internal" href="#shift-in-time" id="id3">Shift in time</a></p></li>
<li><p><a class="reference internal" href="#derivatives" id="id4">Derivatives</a></p></li>
<li><p><a class="reference internal" href="#convolution" id="id5">Convolution</a></p></li>
<li><p><a class="reference internal" href="#real-functions" id="id6">Real functions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#application-to-the-harmonic-oscillator" id="id7">Application to the harmonic oscillator</a></p>
<ul>
<li><p><a class="reference internal" href="#green-function" id="id8">Green function</a></p></li>
<li><p><a class="reference internal" href="#response-function" id="id9">Response function</a></p></li>
<li><p><a class="reference internal" href="#amplitude-factor-and-phase" id="id10">Amplitude factor and phase</a></p></li>
<li><p><a class="reference internal" href="#sinusoidal-ground-motion" id="id11">Sinusoidal ground motion</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="full-width docutils">
<p>In this chapter, we will briefly review the Fourier transform of time dependent function and how we can numerically evaluate it applying the discrete Fourier transform to a regular sampling of the function over a finite time window. We will also discuss the expansion in Fourier series of periodic functions and how it consitute the link between the Fourier transform and its discrete counterpart.</p>
</div>
<section id="introduction">
<h2><a class="toc-backref" href="#id1"><span class="section-number">4.1. </span>Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<div class="full-width docutils">
<p>The Fourier transform of a function in the time domain <span class="math notranslate nohighlight">\(f(t)\)</span> is defined as</p>
<div class="math notranslate nohighlight" id="equation-t1-1">
<span class="eqno">(4.1)<a class="headerlink" href="#equation-t1-1" title="Permalink to this equation">#</a></span>\[
\begin{align}
\tilde{f}(\omega) &amp;= \int_{-\infty}^\infty f(t)\,e^{-i\,\omega\,t}\,\mathrm{d} t &amp;
\end{align}
\]</div>
<p>Here <span class="math notranslate nohighlight">\(t\)</span> is the time, <span class="math notranslate nohighlight">\(\omega=2\,\pi\,f\)</span> is the angular frequency (with <span class="math notranslate nohighlight">\(f\)</span> being the frequency), <span class="math notranslate nohighlight">\(i\)</span> is the imaginary unit and the tilde <span class="math notranslate nohighlight">\(\sim\)</span> stands for the Fourier transform.</p>
<p>We can also define the inverse Fourier transform</p>
<div class="math notranslate nohighlight" id="equation-t1-2">
<span class="eqno">(4.2)<a class="headerlink" href="#equation-t1-2" title="Permalink to this equation">#</a></span>\[
f(t)  = \frac{1}{2\,\pi} \int_{-\infty}^\infty \tilde{f}(\omega)\,e^{i\,\omega\,t}\,\mathrm{d} \omega
\]</div>
<p>which yields the function in the time domain <span class="math notranslate nohighlight">\(f(t)\)</span> starting from its Fourier transform <span class="math notranslate nohighlight">\(\tilde{f}(\omega)\)</span>.</p>
<p>Eq. <a class="reference internal" href="#equation-t1-2">(4.2)</a> allows us to see the function in the time domain as the superimposition of monochromaic signals (with given frequencies) where the Fourier transform provides the weight of each monochromatic signal.</p>
</div>
<div class="note full-width admonition">
<p class="admonition-title">Dirac delta function</p>
<p>Let us consider the Dirac delta function in the time domain <span class="math notranslate nohighlight">\(\delta(t)\)</span> introduced in <a class="reference internal" href="Z0_Dirac.html#chap-dirac-delta"><span class="std std-numref">Appendix 10</span></a> <a class="reference internal" href="Z0_Dirac.html#chap-dirac-delta"><span class="std std-ref">Dirac delta function</span></a>. Its Fourier transform</p>
<div class="math notranslate nohighlight" id="equation-t1-3">
<span class="eqno">(4.3)<a class="headerlink" href="#equation-t1-3" title="Permalink to this equation">#</a></span>\[
\tilde{\delta}(\omega) = \int_{-\infty}^\infty \delta(t)\,e^{-i\,\omega\,t}\,\mathrm{d} t = 1
\]</div>
<p>From eq. <a class="reference internal" href="#equation-t1-2">(4.2)</a>, we obtain</p>
<div class="math notranslate nohighlight" id="equation-t1-4">
<span class="eqno">(4.4)<a class="headerlink" href="#equation-t1-4" title="Permalink to this equation">#</a></span>\[
\delta(t) = \frac{1}{2\,\pi}\,\int_{-\infty}^\infty \tilde{\delta}(\omega)\,e^{i\,\omega\,t}\,\mathrm{d} \omega = \frac{1}{2\,\pi}\,\int_{-\infty}^\infty e^{i\,\omega\,t}\,\mathrm{d} \omega
\]</div>
<p>which can be generalized with a shift in time as follows</p>
<div class="math notranslate nohighlight" id="equation-t1-5">
<span class="eqno">(4.5)<a class="headerlink" href="#equation-t1-5" title="Permalink to this equation">#</a></span>\[
\delta(t-\tau) = \frac{1}{2\,\pi}\,\int_{-\infty}^\infty e^{i\,\omega\,(t-\tau)}\,\mathrm{d} \omega
\]</div>
<p>By reversing the role of <span class="math notranslate nohighlight">\(\omega\)</span> and <span class="math notranslate nohighlight">\(t\)</span> and substitutìng <span class="math notranslate nohighlight">\(\tau\rightarrow\omega_g\)</span>, we can also write</p>
<div class="math notranslate nohighlight" id="equation-t1-5bis">
<span class="eqno">(4.6)<a class="headerlink" href="#equation-t1-5bis" title="Permalink to this equation">#</a></span>\[
\delta(\omega-\omega_g) = \frac{1}{2\,\pi}\,\int_{-\infty}^\infty e^{i\,(\omega-\omega_g)\,t}\,\mathrm{d} t
\]</div>
<p>Eqs. <a class="reference internal" href="#equation-t1-5">(4.5)</a> and <a class="reference internal" href="#equation-t1-5bis">(4.6)</a> are useful identities that we shall use in evaluating the Fourier transform of monochromatic signals.</p>
</div>
<div class="note full-width admonition">
<p class="admonition-title">Box function</p>
<p>Let us consider the box function  <span class="math notranslate nohighlight">\(B_T(t)\)</span> in the time interval <span class="math notranslate nohighlight">\([0,T)\)</span></p>
<div class="math notranslate nohighlight" id="equation-t1-6">
<span class="eqno">(4.7)<a class="headerlink" href="#equation-t1-6" title="Permalink to this equation">#</a></span>\[\begin{split}
B_T(t) = H(t)-H(t-T) =\begin{cases} 1 &amp; t\in[0,T) \\ 0 &amp; t\notin [0,T)
\end{cases}
\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(H\)</span> being the Heaviside step function</p>
<div class="math notranslate nohighlight" id="equation-t1-7">
<span class="eqno">(4.8)<a class="headerlink" href="#equation-t1-7" title="Permalink to this equation">#</a></span>\[\begin{split}
H(x) = \begin{cases} 1 &amp; x \geq 0 \\ 0 &amp; x&lt;0 \end{cases}
\end{split}\]</div>
<p>Its Fourier transform reads</p>
<div class="math notranslate nohighlight" id="equation-t1-8">
<span class="eqno">(4.9)<a class="headerlink" href="#equation-t1-8" title="Permalink to this equation">#</a></span>\[
\begin{align}
\tilde{B}_T(\omega) &amp;= \int_{-\infty}^\infty B_T(t)\,e^{-i\,\omega\,t}\,\mathrm{d} t = \int_0^T e^{-i\,\omega\,t}\,\mathrm{d} t = \left.\frac{e^{-i\,\omega\,t}}{-i\,\omega}\right|_0^T = \frac{1-e^{-i\,\omega\,T}}{i\,\omega}
\end{align}
\]</div>
</div>
<div class="full-width admonition caution">
<p class="admonition-title">Caution</p>
<p>Despite the denominator in eq. <a class="reference internal" href="#equation-t1-8">(4.9)</a>, <span class="math notranslate nohighlight">\(\tilde{B}(\omega)\)</span> is continuous at <span class="math notranslate nohighlight">\(\omega=0\)</span> as shown hereinafter</p>
<div class="math notranslate nohighlight" id="equation-t1-9">
<span class="eqno">(4.10)<a class="headerlink" href="#equation-t1-9" title="Permalink to this equation">#</a></span>\[
\begin{align}
&amp; \lim_{\omega \rightarrow 0} \tilde{B}_T(\omega) = \lim_{\omega \rightarrow 0} \frac{1-(1-i\,\omega\,T)}{i\,\omega} = T
\end{align}
\]</div>
<p>In order to avoid any numerical issue in evaluating this Fourier transform at <span class="math notranslate nohighlight">\(\omega=0\)</span>, it is convinient to implement the following form</p>
<div class="math notranslate nohighlight" id="equation-t1-10">
<span class="eqno">(4.11)<a class="headerlink" href="#equation-t1-10" title="Permalink to this equation">#</a></span>\[
\begin{align}
\tilde{B}_T(\omega) &amp;= e^{-i \frac{\omega\,T}{2}}\,\frac{e^{i \frac{\omega\,T}{2}}-e^{-i \frac{\omega\,T}{2}}}{i\,\omega} = e^{-i \frac{\omega\,T}{2}}\, \frac{2\,\sin\big(\frac{\omega\,T}{2}\big)}{\omega} = T\,e^{-i\,\frac{\omega\,T}{2}}\,J\big(\tfrac{\omega\,T}{2}\big)
\end{align} 
\]</div>
<p>where <span class="math notranslate nohighlight">\(J\)</span> is the spherical Bessel function of the first kind and order 0</p>
<div class="math notranslate nohighlight" id="equation-t1-11">
<span class="eqno">(4.12)<a class="headerlink" href="#equation-t1-11" title="Permalink to this equation">#</a></span>\[
J(x) = \frac{\sin(x)}{x}
\]</div>
</div>
<p><font size="4"> Exercise </font></p>
<div class="full-width docutils">
<p>Let us consider the Box function and its Fourier transform, eqs. <a class="reference internal" href="#equation-t1-6">(4.7)</a> and <a class="reference internal" href="#equation-t1-10">(4.11)</a></p>
<p><strong>Tasks:</strong></p>
<ol class="simple">
<li><p>Make a Python function for the Box function <span class="math notranslate nohighlight">\(B_T(t)\)</span> and plot it</p></li>
<li><p>Make a Python function for the 0-order spherical Bessel function <span class="math notranslate nohighlight">\(j_n(x)\)</span> and make sure that you can evaluate at <span class="math notranslate nohighlight">\(x=0\)</span></p></li>
<li><p>Make a Python function for the Fourier transform of the Box function <span class="math notranslate nohighlight">\(\tilde{B}_T(t)\)</span> and plot it</p></li>
</ol>
</div>
<div class="full-width docutils">
<p><strong>Solution 1</strong></p>
<p>Let us implement the Box function</p>
</div>
<div class="cell tag_full-width tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">eva_box</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">box</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">box</span><span class="p">[</span><span class="n">ts</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span>  <span class="o">=</span> <span class="mi">0</span>
    <span class="n">box</span><span class="p">[</span><span class="n">ts</span><span class="o">&gt;=</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">return</span> <span class="n">box</span>
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<p>and plot it</p>
</div>
<div class="cell tag_full-width tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">,</span><span class="mi">10001</span><span class="p">)</span>
<span class="n">box</span> <span class="o">=</span> <span class="n">eva_box</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">box</span><span class="p">);</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/C1_Fourier_6_0.png" src="../_images/C1_Fourier_6_0.png" />
</div>
</div>
<div class="full-width docutils">
<p><strong>Solution 2</strong></p>
</div>
<div class="full-width docutils">
<p>Let us import the function <code class="docutils literal notranslate"><span class="pre">spherical_jn</span></code> from the module <code class="docutils literal notranslate"><span class="pre">scipy.special</span></code> and make a lambda function setting to zero the order <span class="math notranslate nohighlight">\(n\)</span> (that is the first argument of the function <code class="docutils literal notranslate"><span class="pre">spherical_jn</span></code>)</p>
</div>
<div class="cell tag_full-width tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">spherical_jn</span>
<span class="n">J</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">spherical_jn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<p><strong>Solution 3</strong></p>
<p>Let us implement the Fourier transform of the box function and plot it</p>
</div>
<div class="cell tag_full-width tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#########################################################################</span>
<span class="k">def</span> <span class="nf">eva_FT_box</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">ws</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">fs</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">ws</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">FT_box</span> <span class="o">=</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">xs</span><span class="p">)</span> <span class="o">*</span> <span class="n">J</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">FT_box</span>
<span class="c1">#########################################################################</span>

<span class="n">fs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="o">/</span><span class="n">T</span><span class="p">,</span><span class="mi">10</span><span class="o">/</span><span class="n">T</span><span class="p">,</span><span class="mi">10001</span><span class="p">)</span>
<span class="n">FT_box</span> <span class="o">=</span> <span class="n">eva_FT_box</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency [Hz]&quot;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span><span class="n">FT_box</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Re&quot;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span><span class="n">FT_box</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Im&quot;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/C1_Fourier_11_0.png" src="../_images/C1_Fourier_11_0.png" />
</div>
</div>
<div class="full-width docutils">
<p>We note that the Fourier transform is a complex function and, so, we plot both its real and imaginary parts. Also, we can see that the real part is symmetric with respect to the origin, while the imaginary part is antisymmetric. This is because the box function is a real function.</p>
<p>The functions <code class="docutils literal notranslate"><span class="pre">eva_box</span></code>, <code class="docutils literal notranslate"><span class="pre">eva_FT_box</span></code> and <code class="docutils literal notranslate"><span class="pre">J</span></code> are also implemented in the <code class="docutils literal notranslate"><span class="pre">theory</span></code> module.</p>
</div>
</section>
<section id="properties-of-the-fourier-transform">
<h2><a class="toc-backref" href="#id2"><span class="section-number">4.2. </span>Properties of the Fourier transform</a><a class="headerlink" href="#properties-of-the-fourier-transform" title="Permalink to this headline">#</a></h2>
<div class="full-width docutils">
<p>Hereinafter we list the main properties of the Fourier transform</p>
</div>
<section id="shift-in-time">
<h3><a class="toc-backref" href="#id3"><span class="section-number">4.2.1. </span>Shift in time</a><a class="headerlink" href="#shift-in-time" title="Permalink to this headline">#</a></h3>
<div class="full-width docutils">
<p>The Fourier transform of a function shifted in time <span class="math notranslate nohighlight">\(f(t+t_0)\)</span> yields the Fourier transform <span class="math notranslate nohighlight">\(\tilde{f}(\omega)\)</span> multiplied by <span class="math notranslate nohighlight">\(e^{i\,\omega\,t_0}\)</span></p>
<div class="math notranslate nohighlight" id="equation-t1-12">
<span class="eqno">(4.13)<a class="headerlink" href="#equation-t1-12" title="Permalink to this equation">#</a></span>\[
\begin{align}
\int_{-\infty}^\infty f(t+t_0)\,e^{-i\,\omega\,t}\,\mathrm{d}t 
= e^{i\,\omega\,t_0}\,\tilde{f}(\omega)
\end{align}
\]</div>
</div>
</section>
<section id="derivatives">
<h3><a class="toc-backref" href="#id4"><span class="section-number">4.2.2. </span>Derivatives</a><a class="headerlink" href="#derivatives" title="Permalink to this headline">#</a></h3>
<div class="full-width docutils">
<p>The Fourier transform of a <span class="math notranslate nohighlight">\(n\)</span>-th order time derivative of a function <span class="math notranslate nohighlight">\(f(t)\)</span> yields the Fourier transform <span class="math notranslate nohighlight">\(\tilde{f}(\omega)\)</span> multiplied by <span class="math notranslate nohighlight">\((i\,\omega)^n\)</span></p>
<div class="math notranslate nohighlight" id="equation-t1-13">
<span class="eqno">(4.14)<a class="headerlink" href="#equation-t1-13" title="Permalink to this equation">#</a></span>\[
\begin{align}
\int_{-\infty}^\infty \frac{\mathrm{d}^n f(t)}{\mathrm{d} t^n}\,e^{-i\,\omega\,t}\,\mathrm{d}t = (i\,\omega)^n\,\tilde{f}(\omega)
\end{align}
\]</div>
</div>
</section>
<section id="convolution">
<h3><a class="toc-backref" href="#id5"><span class="section-number">4.2.3. </span>Convolution</a><a class="headerlink" href="#convolution" title="Permalink to this headline">#</a></h3>
<div class="full-width docutils">
<p>The Fourier transform of the convolution between two functions <span class="math notranslate nohighlight">\(f(t)\)</span> and <span class="math notranslate nohighlight">\(g(t)\)</span></p>
<div class="math notranslate nohighlight" id="equation-t1-14">
<span class="eqno">(4.15)<a class="headerlink" href="#equation-t1-14" title="Permalink to this equation">#</a></span>\[
h(t) = \int_{-\infty}^\infty f(\tau)\,g(t-\tau)\,\mathrm{d}\tau 
\]</div>
<p>yields the product of the two Fourier transforms <span class="math notranslate nohighlight">\(\tilde{f}(\omega)\)</span> and <span class="math notranslate nohighlight">\(\tilde{g}(\omega)\)</span></p>
<div class="math notranslate nohighlight" id="equation-t1-15">
<span class="eqno">(4.16)<a class="headerlink" href="#equation-t1-15" title="Permalink to this equation">#</a></span>\[
\begin{align}
\int_{-\infty}^\infty h(t)\,e^{-i\,\omega\,t}\,\mathrm{d}t = \tilde{f}(\omega)\,\tilde{g}(\omega)
\end{align}
\]</div>
</div>
</section>
<section id="real-functions">
<h3><a class="toc-backref" href="#id6"><span class="section-number">4.2.4. </span>Real functions</a><a class="headerlink" href="#real-functions" title="Permalink to this headline">#</a></h3>
<div class="full-width docutils">
<p>The Fourier transform of a real function <span class="math notranslate nohighlight">\(f(t)\)</span> has the following property</p>
<div class="math notranslate nohighlight" id="equation-t1-16">
<span class="eqno">(4.17)<a class="headerlink" href="#equation-t1-16" title="Permalink to this equation">#</a></span>\[
\tilde{f}^*(\omega) = \tilde{f}(-\omega)
\]</div>
<p>We thus can write its inverse Fourier transform as follows</p>
<div class="math notranslate nohighlight" id="equation-t1-17">
<span class="eqno">(4.18)<a class="headerlink" href="#equation-t1-17" title="Permalink to this equation">#</a></span>\[
f(t) = \frac{1}{\pi}\,\Re\left[\int_0^\infty \tilde{f}(\omega)\,e^{i\,\omega\,t}\right]\,\mathrm{d} \omega = \frac{1}{\pi}\,\int_0^\infty \Big(\Re\big[\tilde{f}(\omega)\big]\,\cos(\omega\,t) - \Im\big[\tilde{f}(\omega)\big]\,\sin(\omega\,t) \Big)\,\mathrm{d} \omega
\]</div>
<p>where <span class="math notranslate nohighlight">\(\Re\)</span> and <span class="math notranslate nohighlight">\(\Im\)</span> are the operators which returns the real and imaginary parts.</p>
</div>
</section>
</section>
<hr class="docutils" />
<section id="application-to-the-harmonic-oscillator">
<h2><a class="toc-backref" href="#id7"><span class="section-number">4.3. </span>Application to the harmonic oscillator</a><a class="headerlink" href="#application-to-the-harmonic-oscillator" title="Permalink to this headline">#</a></h2>
<div class="full-width docutils">
<p>After Fourier transform and making use of eq. <a class="reference internal" href="#equation-t1-13">(4.14)</a>, the differential equation governing the harmonic oscillator, eq. <a class="reference internal" href="C0_Harmonic.html#equation-h0-6">(3.6)</a>, becomes</p>
<div class="math notranslate nohighlight" id="equation-t1-18">
<span class="eqno">(4.19)<a class="headerlink" href="#equation-t1-18" title="Permalink to this equation">#</a></span>\[
\big(-\omega^2+2\,i\,\omega\,\lambda+\omega_0^2\big)\,\tilde{z}(\omega) = \omega^2\,\tilde{u}(\omega)
\]</div>
</div>
<section id="green-function">
<h3><a class="toc-backref" href="#id8"><span class="section-number">4.3.1. </span>Green function</a><a class="headerlink" href="#green-function" title="Permalink to this headline">#</a></h3>
<div class="full-width docutils">
<p>It can be solved for the Fourier transform of the relative motion <span class="math notranslate nohighlight">\(\tilde{z}\)</span>  and cast in the following form</p>
<div class="math notranslate nohighlight" id="equation-t1-19">
<span class="eqno">(4.20)<a class="headerlink" href="#equation-t1-19" title="Permalink to this equation">#</a></span>\[
\tilde{z}(\omega) = \tilde{G}(\omega)\,\big(-\omega^2\,\tilde{u}(\omega)\big)
\]</div>
<p>with</p>
<div class="math notranslate nohighlight" id="equation-t1-20">
<span class="eqno">(4.21)<a class="headerlink" href="#equation-t1-20" title="Permalink to this equation">#</a></span>\[
\tilde{G}(\omega) = -\frac{1}{\omega_0^2-\omega^2+2\,i\,\omega\,\lambda}
\]</div>
<p>In view of eqs. <a class="reference internal" href="C0_Harmonic.html#equation-h0-28">(3.28)</a> and <a class="reference internal" href="#equation-t1-15">(4.16)</a>, we can understand that <span class="math notranslate nohighlight">\(\tilde{G}\)</span> is the Fourier transform of the Green function of the harmonic oscilator, eq. <a class="reference internal" href="C0_Harmonic.html#equation-h0-35bis">(3.36)</a>, that we rewrite here as follows</p>
<div class="math notranslate nohighlight" id="equation-t1-21">
<span class="eqno">(4.22)<a class="headerlink" href="#equation-t1-21" title="Permalink to this equation">#</a></span>\[
\begin{align}
G(t) 
&amp;= -\frac{\sin(\omega_d\,t)\,e^{-\lambda\,t}}{\omega_d}\,H(t) 
= \frac{e^{\gamma_-\,t}-e^{\gamma_+\,t}}{2\,i\,\omega_d}\,H(t) 
\end{align}
\]</div>
<p>We can verify this remark by evaluating the Fourier transform</p>
<div class="math notranslate nohighlight" id="equation-t1-22">
<span class="eqno">(4.23)<a class="headerlink" href="#equation-t1-22" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{align}
\tilde{G}(\omega) &amp;= \int_{-\infty}^\infty G(t)\,e^{-i\,\omega\,t}\,dt = \frac{1}{2\,i\,\omega_d}\,\int_0^\infty \left(e^{(\gamma_--i\,\omega)\,t}-e^{(\gamma_+-i\,\omega)\,t}\right)\,d t  = \frac{1}{2\,i\,\omega_d}\,\left.\left(\frac{e^{(\gamma_--i\,\omega)\,t}}{\gamma_--i\,\omega}-\frac{e^{(\gamma_+-i\,\omega)\,t}}{\gamma_+-i\,\omega}\right)\right|_0^\infty 
\\
&amp;= \frac{1}{2\,i\,\omega_d}\,\left(\frac{1}{\gamma_+-i\,\omega}-\frac{1}{\gamma_--i\,\omega}\right)
= \frac{1}{2\,i\,\omega_d}\,\left(\frac{\gamma_- - \gamma_+}{(\gamma_+-i\,\omega)\,(\gamma_--i\,\omega)}\right) = -\frac{1}{\omega_0^2-\omega^2+2\,i\,\omega\,\lambda}
\end{align}
\end{split}\]</div>
<p>where we make use of the following identities</p>
<div class="math notranslate nohighlight" id="equation-t1-23">
<span class="eqno">(4.24)<a class="headerlink" href="#equation-t1-23" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{align}
&amp; \lim_{t\rightarrow \infty} e^{(\gamma_\pm-i\,\omega)\,t} = 0 
\\
&amp;\gamma_- - \gamma_+ = -2\,i\,\omega_d
\\
&amp;(\gamma_+-i\,\omega)\,(\gamma_+-i\,\omega) = \omega_0^2-\omega^2+2\,\,i\,\omega\,\lambda
\end{align}
\end{split}\]</div>
</div>
</section>
<section id="response-function">
<h3><a class="toc-backref" href="#id9"><span class="section-number">4.3.2. </span>Response function</a><a class="headerlink" href="#response-function" title="Permalink to this headline">#</a></h3>
<div class="full-width docutils">
<p>Similar, by rewriting eq. <a class="reference internal" href="#equation-t1-18">(4.19)</a> as follows</p>
<div class="math notranslate nohighlight" id="equation-t1-24">
<span class="eqno">(4.25)<a class="headerlink" href="#equation-t1-24" title="Permalink to this equation">#</a></span>\[
\tilde{z}(\omega) = \tilde{R}(\omega)\,\tilde{u}(\omega)
\]</div>
<p>with</p>
<div class="math notranslate nohighlight" id="equation-t1-25">
<span class="eqno">(4.26)<a class="headerlink" href="#equation-t1-25" title="Permalink to this equation">#</a></span>\[
\tilde{R}(\omega) = \frac{\omega^2}{\omega_0^2-\omega^2+2\,i\,\omega\,\lambda}
\]</div>
<p>we can understand that <span class="math notranslate nohighlight">\(\tilde{R}\)</span> is the Fourier transform of the response function of the harmonic oscillator, eq. <a class="reference internal" href="C0_Harmonic.html#equation-h0-37">(3.38)</a>.</p>
</div>
</section>
<section id="amplitude-factor-and-phase">
<h3><a class="toc-backref" href="#id10"><span class="section-number">4.3.3. </span>Amplitude factor and phase</a><a class="headerlink" href="#amplitude-factor-and-phase" title="Permalink to this headline">#</a></h3>
<div class="full-width docutils">
<p>Let us recast eq. <a class="reference internal" href="#equation-t1-25">(4.26)</a> in the exponential form as follows</p>
<div class="math notranslate nohighlight" id="equation-t1-26">
<span class="eqno">(4.27)<a class="headerlink" href="#equation-t1-26" title="Permalink to this equation">#</a></span>\[
\tilde{R}(\omega) = \rho(\omega)\,e^{i\,\phi(\omega)}
\]</div>
<p>where the module <span class="math notranslate nohighlight">\(\rho\)</span> and the phase <span class="math notranslate nohighlight">\(\beta\)</span> are given by</p>
<div class="math notranslate nohighlight" id="equation-t1-27">
<span class="eqno">(4.28)<a class="headerlink" href="#equation-t1-27" title="Permalink to this equation">#</a></span>\[
\rho(\omega)= \frac{\omega^2}{D}
 \qquad \cos\phi(\omega) = \frac{\omega_0^2-\omega^2}{D} \qquad \sin\phi(\omega) = \frac{-2\,\omega\,\lambda}{D}
\]</div>
<p>with <span class="math notranslate nohighlight">\(D\)</span>, as in eq. <a class="reference internal" href="C0_Harmonic.html#equation-h0-51">(3.52)</a>, given by</p>
<div class="math notranslate nohighlight" id="equation-t1-28">
<span class="eqno">(4.29)<a class="headerlink" href="#equation-t1-28" title="Permalink to this equation">#</a></span>\[
D = \sqrt{\big(\omega_0^2-\omega^2\big)^2+\big(2\,\omega\,\lambda\big)^2}
\]</div>
<p>We note that the module <span class="math notranslate nohighlight">\(\rho\)</span> is symmetric while <span class="math notranslate nohighlight">\(\beta\)</span> is antisimmetric with respect to <span class="math notranslate nohighlight">\(\omega\)</span></p>
<div class="math notranslate nohighlight" id="equation-t1-29">
<span class="eqno">(4.30)<a class="headerlink" href="#equation-t1-29" title="Permalink to this equation">#</a></span>\[
\rho(-\omega) = \rho(\omega)
\qquad \beta(-\omega) = -\beta(\omega) 
\]</div>
<p>Also, we note that they correspond to the amplitude factor and phase already obtained in eqs. <a class="reference internal" href="C0_Harmonic.html#equation-h0-51">(3.52)</a> and <a class="reference internal" href="C0_Harmonic.html#equation-h0-53">(3.54)</a> when the angular frequency <span class="math notranslate nohighlight">\(\omega\)</span> is regarded as the ground angular frequency <span class="math notranslate nohighlight">\(\omega_g\)</span>. We will the reason of this correspondence in the next subsection.</p>
<p>Before, let us implement in python the Fourier transform of the Green and response functions</p>
</div>
<div class="cell tag_full-width tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">theory</span> <span class="kn">import</span> <span class="n">eva_FT_green</span><span class="p">,</span> <span class="n">eva_FT_response</span>

<span class="n">help</span><span class="p">(</span><span class="n">eva_FT_green</span><span class="p">)</span>
<span class="n">help</span><span class="p">(</span><span class="n">eva_FT_response</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function eva_FT_green in module theory:

eva_FT_green(f, natural_period=1, damping_ratio=0.1)
    
    Return the green function in the frequency domain evaluated 
    at the frequency (or frequencies) `f` for the harmonic oscillator 
    with given natural period and damping ratio

Help on function eva_FT_response in module theory:

eva_FT_response(f, natural_period=1, damping_ratio=0.1)
    
    Return the response function in the frequency domain evaluated 
    at the frequency (or frequencies) `f` for the harmonic oscillator 
    with given natural period and damping ratio
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<p>and plot their module and phase</p>
</div>
<div class="cell tag_full-width tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="mf">1e1</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1001</span><span class="p">)</span>
<span class="n">FT_green</span> <span class="o">=</span> <span class="n">eva_FT_green</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span>
<span class="n">FT_response</span> <span class="o">=</span> <span class="n">eva_FT_response</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">FT_green</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Green&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">FT_green</span><span class="p">,</span><span class="n">deg</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Green&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">FT_response</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Response&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">FT_response</span><span class="p">,</span><span class="n">deg</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Response&quot;</span><span class="p">)</span>

<span class="n">options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Amplitude&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Phase&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Phase&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">180</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency [Hz]&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/C1_Fourier_21_0.png" src="../_images/C1_Fourier_21_0.png" />
</div>
</div>
<div class="full-width docutils">
<p>The Fourier transform of the response function describes how the relative motion of the mass is related to the
ground motion for each frequency. In particular, it provides the ratio
between the Fourier transform of the relative displacement, <span class="math notranslate nohighlight">\(\tilde{z}\)</span>,
and that of the ground displacement, <span class="math notranslate nohighlight">\(\tilde{u}_g\)</span>. We
note that, for high frequencies, in the limit for
<span class="math notranslate nohighlight">\(\omega\rightarrow\infty\)</span>, the frequency response function goes to
<span class="math notranslate nohighlight">\(-1\)</span>, meaning that <span class="math notranslate nohighlight">\(\tilde{z}(\omega) = -\tilde{u}(\omega)\)</span>.
This means that the relative
displacement of the mass is opposite (a phase shift of <span class="math notranslate nohighlight">\(-\pi\)</span>) to a high frequency ground motion, so
that the mass is at rest in the inertial reference frame. On the
contrary, for low frequency ground motion, in the limit for
<span class="math notranslate nohighlight">\(\omega\rightarrow 0\)</span>, there is no relative motion and, so, the
mass simply follows the ground motion. At the resonance frequency,
instead, the push from the ground occurs when the mass is at top or
bottom position (the amplitude of which depends on the damping ratio,
<span class="math notranslate nohighlight">\(\xi\)</span>) and there is a phase shift of <span class="math notranslate nohighlight">\(-\pi/2\)</span> (like when
we push a swing at the right time).</p>
</div>
</section>
<section id="sinusoidal-ground-motion">
<h3><a class="toc-backref" href="#id11"><span class="section-number">4.3.4. </span>Sinusoidal ground motion</a><a class="headerlink" href="#sinusoidal-ground-motion" title="Permalink to this headline">#</a></h3>
<div class="full-width docutils">
<p>In order to undrestand the reason of this correspondence, let us consider the differential equation for the steady-state relatiev motion already discussed in the time domain, eq. <a class="reference internal" href="C0_Harmonic.html#equation-h0-42">(3.43)</a>, that we rewrite here</p>
<div class="math notranslate nohighlight" id="equation-t1-30">
<span class="eqno">(4.31)<a class="headerlink" href="#equation-t1-30" title="Permalink to this equation">#</a></span>\[
\ddot{z}_p(t)+2\,\lambda\,\dot{z}_p(t)+\omega_0\,z_\mathrm{p}(t) = -g(t)
\]</div>
<p>with <span class="math notranslate nohighlight">\(g\)</span> being the ground acceleration that we recast as follows</p>
<div class="math notranslate nohighlight" id="equation-t1-31">
<span class="eqno">(4.32)<a class="headerlink" href="#equation-t1-31" title="Permalink to this equation">#</a></span>\[
g(t) = A_g\,\sin(\omega_g\,t+\phi_g) = A_g\,\frac{e^{i\,\omega_g\,t+i\,\phi_g} - e^{-i\,\omega_g\,t-i\,\phi_g}}{2\,i}
\]</div>
<p>Its Fourier transform yields</p>
<div class="math notranslate nohighlight" id="equation-t1-32">
<span class="eqno">(4.33)<a class="headerlink" href="#equation-t1-32" title="Permalink to this equation">#</a></span>\[
\tilde{g}(\omega) = \int_{-\infty}^\infty g(t)\,e^{-i\,\omega\,t}\,d t = \frac{A_g}{2\,i}\,\int_{-\infty}^\infty \left(e^{i\,(\omega_g-\omega)\,t+i\,\phi_g} - e^{-i\,(\omega_g+\omega)\,t-i\,\phi_g}\right)\,dt = \frac{\pi\,A_g}{i}\,\left(\delta(\omega-\omega_g)\,e^{i\,\phi_g}-\delta(\omega+\omega_g)\,e^{-i\,\phi_g}\right)
\]</div>
<p>It is noteworthy that it is characterized only by the frequency <span class="math notranslate nohighlight">\(\omega=\pm\omega_g\)</span> and this is due to the fact that it is a monocromatic signal with angular frequency <span class="math notranslate nohighlight">\(\omega_g\)</span>.</p>
<p>Let us now consider the Fourier transform of the relative acceleration and write it as the product of the Fourier transform of the response function and of the ground acceleration</p>
<div class="math notranslate nohighlight" id="equation-t1-33">
<span class="eqno">(4.34)<a class="headerlink" href="#equation-t1-33" title="Permalink to this equation">#</a></span>\[
-\omega^2\,\tilde{z}_p(\omega) = \tilde{R}(\omega)\,\tilde{g}(\omega) = \frac{\pi\,A_g}{i}\,\left(\delta(\omega-\omega_g)\,e^{i\,\phi_g}-\delta(\omega+\omega_g)\,e^{-i\,\phi_g}\right)\,\tilde{R}(\omega)
\]</div>
<p>and take its inverse Fourier transform</p>
<div class="math notranslate nohighlight" id="equation-t1-34">
<span class="eqno">(4.35)<a class="headerlink" href="#equation-t1-34" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{align}
\ddot{z}_p(t) &amp;= \frac{1}{2\,\pi}\,\int_{-\infty}^\infty \big(-\omega^2\,\tilde{z}_p(\omega)\big)\,e^{i\,\omega\,t}\,d \omega = \frac{A_g}{2\,i}\,\int_{-\infty}^\infty \left(\delta(\omega-\omega_g)\,e^{i\,\phi_g}-\delta(\omega+\omega_g)\,e^{-i\,\phi_g}\right)\,\tilde{R}(\omega)\,e^{i\,\omega\,t}\,d \omega 
\\
&amp;= \frac{A_g}{2\,i}\,\left(R(\omega_g)\,e^{i\,(\omega_g\,t+\phi_g)}-R(-\omega_g)\,e^{-i\,(\omega_g\,t+\phi_g)}\right) = \frac{A_g}{2\,i}\,\rho(\omega_g)\,\left(e^{i\,(\omega_g\,t+\phi_g+\phi(\omega_g))}-e^{-i\,(\omega_g\,t+\phi_g+\phi(\omega_g))}\right) \\
&amp;= A_g\,\rho(\omega_g)\,\sin\big(\omega_g\,t+\phi_g+\phi(\omega_g)\big)
\end{align}
\end{split}\]</div>
<p>This result coincides with the solution given by eq. <a class="reference internal" href="C0_Harmonic.html#equation-h0-48">(3.49)</a> and derived in the time domain just because <span class="math notranslate nohighlight">\(\rho(\omega_g)\)</span> and <span class="math notranslate nohighlight">\(\phi(\omega_g)\)</span> coincides with the amplitude factor and phase, eqs. <a class="reference internal" href="C0_Harmonic.html#equation-h0-51">(3.52)</a> and <a class="reference internal" href="C0_Harmonic.html#equation-h0-53">(3.54)</a>. It also shows how the Fourier transform provides an alternative method for solving differential equations.</p>
</div>
<p style="page-break-after:always;"></p></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./files"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="C0_Harmonic.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">3. </span>Harmonic oscillators</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="C2_Discrete.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Discrete Fourier transform</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By <a href="https://sites.unimi.it/gcambiotti/">Gabriele Cambiotti</a><br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>