
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3. Harmonic oscillators &#8212; Seismology</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Fourier transform" href="C1_Fourier.html" />
    <link rel="prev" title="2. Tutorial on Python" href="A1_Tutorial.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/gc_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Seismology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Setup
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="A0_Setup.html">
   1. Working with JupyterLab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="A1_Tutorial.html">
   2. Tutorial on Python
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Theory
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   3. Harmonic oscillators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="C1_Fourier.html">
   4. Fourier transform
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="C2_Discrete.html">
   5. Discrete Fourier transform
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Laboratory
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="L0_Seismic_catalogs_and_networks.html">
   6. Seismic catalogs and networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="L1_Waveforms.html">
   7. Waveform processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="L2_Local_magnitude.html">
   8. Local magnitude
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="L3_Earthquake_localization.html">
   9. Earthquake localization
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Z0_Dirac.html">
   10. Dirac delta function
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Z1_Geographic_Maps.html">
   11. Geographic maps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Z2_Inverse_Theory.html">
   12. Inverse problem theory
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Libraries
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Z3_Libraries.html">
   13. Libraries
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#driven-harmonic-oscillators">
   3.1. Driven harmonic oscillators
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#seismometer">
     3.1.1. Seismometer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#building">
     3.1.2. Building
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#damped-harmonic-oscillator">
   3.2. Damped Harmonic oscillator
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#underdamped-harmonic-oscillator">
     3.2.1. Underdamped harmonic oscillator
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initial-conditions">
     3.2.2. Initial conditions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-solution">
   3.3. General solution
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#green-function">
     3.3.1. Green function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#response-function">
     3.3.2. Response function
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sinusoidal-ground-acceleration">
   3.4. Sinusoidal ground acceleration
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#particular-or-steady-state-solution">
     3.4.1. Particular (or steady state) solution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transient-response">
     3.4.2. Transient response
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#test-function">
   3.5. Test function
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dislocation">
     3.5.1. Dislocation
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Harmonic oscillators</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#driven-harmonic-oscillators">
   3.1. Driven harmonic oscillators
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#seismometer">
     3.1.1. Seismometer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#building">
     3.1.2. Building
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#damped-harmonic-oscillator">
   3.2. Damped Harmonic oscillator
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#underdamped-harmonic-oscillator">
     3.2.1. Underdamped harmonic oscillator
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initial-conditions">
     3.2.2. Initial conditions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-solution">
   3.3. General solution
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#green-function">
     3.3.1. Green function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#response-function">
     3.3.2. Response function
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sinusoidal-ground-acceleration">
   3.4. Sinusoidal ground acceleration
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#particular-or-steady-state-solution">
     3.4.1. Particular (or steady state) solution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transient-response">
     3.4.2. Transient response
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#test-function">
   3.5. Test function
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dislocation">
     3.5.1. Dislocation
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="harmonic-oscillators">
<span id="chap-h"></span><h1><span class="section-number">3. </span>Harmonic oscillators<a class="headerlink" href="#harmonic-oscillators" title="Permalink to this headline">#</a></h1>
<div class="contents local topic" id="sections">
<p class="topic-title">Sections</p>
<ul class="simple">
<li><p><a class="reference internal" href="#driven-harmonic-oscillators" id="id1">Driven harmonic oscillators</a></p>
<ul>
<li><p><a class="reference internal" href="#seismometer" id="id2">Seismometer</a></p></li>
<li><p><a class="reference internal" href="#building" id="id3">Building</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#damped-harmonic-oscillator" id="id4">Damped Harmonic oscillator</a></p>
<ul>
<li><p><a class="reference internal" href="#underdamped-harmonic-oscillator" id="id5">Underdamped harmonic oscillator</a></p></li>
<li><p><a class="reference internal" href="#initial-conditions" id="id6">Initial conditions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#general-solution" id="id7">General solution</a></p>
<ul>
<li><p><a class="reference internal" href="#green-function" id="id8">Green function</a></p></li>
<li><p><a class="reference internal" href="#response-function" id="id9">Response function</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#sinusoidal-ground-acceleration" id="id10">Sinusoidal ground acceleration</a></p>
<ul>
<li><p><a class="reference internal" href="#particular-or-steady-state-solution" id="id11">Particular (or steady state) solution</a></p></li>
<li><p><a class="reference internal" href="#transient-response" id="id12">Transient response</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#test-function" id="id13">Test function</a></p>
<ul>
<li><p><a class="reference internal" href="#dislocation" id="id14">Dislocation</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="driven-harmonic-oscillators">
<h2><a class="toc-backref" href="#id1"><span class="section-number">3.1. </span>Driven harmonic oscillators</a><a class="headerlink" href="#driven-harmonic-oscillators" title="Permalink to this headline">#</a></h2>
<div class="full-width docutils">
<p>The driven harmonic oscillator is an useful tool in seismology because it can be used for describing either a simple mechanical seismometer or  the deformation of a building when they are subjected to ground motion.</p>
</div>
<section id="seismometer">
<h3><a class="toc-backref" href="#id2"><span class="section-number">3.1.1. </span>Seismometer</a><a class="headerlink" href="#seismometer" title="Permalink to this headline">#</a></h3>
<figure class="align-center" id="fig-seismometer">
<img alt="../_images/Seismometer.png" src="../_images/Seismometer.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.1 </span><span class="caption-text">Cartoon depicting a seismometer at rest and driven by ground motion (left and right pannels) and the absolute and reference systems.</span><a class="headerlink" href="#fig-seismometer" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="full-width docutils">
<p>Let us consider a seismometer composed by an probe mass attached to a spring and embedded in a viscous dashpot as depicted in <a class="reference internal" href="#fig-seismometer"><span class="std std-numref">Figure 3.1</span></a>. Let us denote with <span class="math notranslate nohighlight">\(h_0\)</span> the height of the probe mass at rest and consider the absolute coordinate of the probe mass <span class="math notranslate nohighlight">\(u\)</span> as the sum of the ground motion <span class="math notranslate nohighlight">\(u_g\)</span>, the height at rest <span class="math notranslate nohighlight">\(h_0\)</span> and its relative motion with respect to it <span class="math notranslate nohighlight">\(z\)</span></p>
<div class="math notranslate nohighlight" id="equation-h0-1">
<span class="eqno">(3.1)<a class="headerlink" href="#equation-h0-1" title="Permalink to this equation">#</a></span>\[
u(t) = u_g(t) + h_0 + z(t)
\]</div>
<p>The elastic, <span class="math notranslate nohighlight">\(F_e\)</span>, and anaelastic, <span class="math notranslate nohighlight">\(F_a\)</span>, forces acting on the probe mass will be given by</p>
<div class="math notranslate nohighlight" id="equation-h0-2">
<span class="eqno">(3.2)<a class="headerlink" href="#equation-h0-2" title="Permalink to this equation">#</a></span>\[
F_e=-k\,z \qquad F_a =-c\,\dot{z}
\]</div>
<p>From the second Newton’s law</p>
<div class="math notranslate nohighlight" id="equation-h0-3">
<span class="eqno">(3.3)<a class="headerlink" href="#equation-h0-3" title="Permalink to this equation">#</a></span>\[
F_e+F_a = m\,\ddot{u}
\]</div>
<p>declined in the case of a machanical seismometer as the one depicted in figure (??), we thus obtain the following differential equation</p>
<div class="math notranslate nohighlight" id="equation-h0-4">
<span class="eqno">(3.4)<a class="headerlink" href="#equation-h0-4" title="Permalink to this equation">#</a></span>\[
-k\,z(t) - c\,\dot{z}(t) = m\,\big(\ddot{u}_g(t)+\ddot{z}(t)\big)
\]</div>
<p>where <span class="math notranslate nohighlight">\(m\)</span> is the probe mass, <span class="math notranslate nohighlight">\(k\)</span> is the elastic constant of the spring and <span class="math notranslate nohighlight">\(c\)</span> is the anaelastic friction. We note that the left hand side is the sum of the total forces acting on the probe mass while the right-hand side is the inertial force, i.e., the mass by its total acceleration.</p>
<p>By dividing eq. <a class="reference internal" href="#equation-h0-4">(3.4)</a> by the mass <span class="math notranslate nohighlight">\(m\)</span> and defining the natural angular frequency <span class="math notranslate nohighlight">\(\omega_0\)</span> and the damping ratio <span class="math notranslate nohighlight">\(\xi\)</span> as follows</p>
<div class="math notranslate nohighlight" id="equation-h0-5">
<span class="eqno">(3.5)<a class="headerlink" href="#equation-h0-5" title="Permalink to this equation">#</a></span>\[
\omega_0 = \sqrt{\frac{k}{m}} \qquad \xi = \frac{c}{2\,\omega_0}
\]</div>
<p>we obtain</p>
<div class="math notranslate nohighlight" id="equation-h0-6">
<span class="eqno">(3.6)<a class="headerlink" href="#equation-h0-6" title="Permalink to this equation">#</a></span>\[
\ddot{z}(t) + 2\,\omega_0\,\xi\,\dot{z}(t) + \omega_0^2\,z(t) = -\ddot{u}_g(t)
\]</div>
<p>that is the classical form of a driven harmonic oscillator, where the left-hand side describes a damped harmonic oscilator and the right-hand side is the driving term that, in the present case, corresponds to minus the ground acceleration.</p>
<p>In the following we will also make use of the natural period of the harmonic oscillator, which is simply given by</p>
<div class="math notranslate nohighlight" id="equation-h0-7">
<span class="eqno">(3.7)<a class="headerlink" href="#equation-h0-7" title="Permalink to this equation">#</a></span>\[
T_0 =  \frac{2\,\pi}{\omega_0} = 2\,\pi\, \sqrt{\frac{m}{k}}
\]</div>
</div>
</section>
<section id="building">
<h3><a class="toc-backref" href="#id3"><span class="section-number">3.1.2. </span>Building</a><a class="headerlink" href="#building" title="Permalink to this headline">#</a></h3>
<figure class="align-center" id="fig-building">
<img alt="../_images/Building.png" src="../_images/Building.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.2 </span><span class="caption-text">Cartoon depicting a building at rest and driven by ground motion (left and right pannels) and the absolute and reference systems.</span><a class="headerlink" href="#fig-building" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="full-width docutils">
<p>Let su consider a building and, as depicted in <a class="reference internal" href="#fig-building"><span class="std std-numref">Figure 3.2</span></a>, denote with <span class="math notranslate nohighlight">\(u\)</span> the absolute coordinate of its top, which can be seen as the sum of the ground motion (i.e., at the bottom of the building) and the building height <span class="math notranslate nohighlight">\(h\)</span></p>
<div class="math notranslate nohighlight" id="equation-h0-8">
<span class="eqno">(3.8)<a class="headerlink" href="#equation-h0-8" title="Permalink to this equation">#</a></span>\[
u(t) = u_g(t) + h(t) 
\]</div>
<p>Due to deformation of the building <span class="math notranslate nohighlight">\(h\)</span> will vary with time and so we also write <span class="math notranslate nohighlight">\(h\)</span> as the sum of its height at rest <span class="math notranslate nohighlight">\(h_0\)</span> and its relative displacement <span class="math notranslate nohighlight">\(z\)</span></p>
<div class="math notranslate nohighlight" id="equation-h0-9">
<span class="eqno">(3.9)<a class="headerlink" href="#equation-h0-9" title="Permalink to this equation">#</a></span>\[
h(t) = h_0 + z(t)
\]</div>
<p>The ratio <span class="math notranslate nohighlight">\(z/h_0\)</span> can be seen as a measure of the internal strain and, so, the elastic and anaelastic forces will be proportional to <span class="math notranslate nohighlight">\(z\)</span> and its time derivative <span class="math notranslate nohighlight">\(\dot{z}\)</span>, respectively</p>
<div class="math notranslate nohighlight" id="equation-h0-10">
<span class="eqno">(3.10)<a class="headerlink" href="#equation-h0-10" title="Permalink to this equation">#</a></span>\[
F_e = -\frac{\mu\,z}{h_0}
\qquad
F_a = -\frac{\eta\,\dot{z}}{h_0}
\]</div>
<p>with <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\eta\)</span> being the elastic modulus and effective viscosity of the building. In thi respect, from the comparison with eq. <a class="reference internal" href="#equation-h0-2">(3.2)</a>, the elastic constant and anaelastic friction of the building are inversely proportional to the building height: <span class="math notranslate nohighlight">\(c\propto h_0^{-1}\)</span> and <span class="math notranslate nohighlight">\(c\propto h_0^{-1}\)</span>.</p>
<p>Similar to the seismometer, from the second Newton’s law, we thus can write</p>
<div class="math notranslate nohighlight" id="equation-h0-11">
<span class="eqno">(3.11)<a class="headerlink" href="#equation-h0-11" title="Permalink to this equation">#</a></span>\[
-k\,z(t) - c\,\dot{z}(t) = m\,\big(\ddot{u}_g(t)+\ddot{z}(t)\big)
\]</div>
<p>and recast it in the form of the driven harmonic oscillator</p>
<div class="math notranslate nohighlight" id="equation-h0-12">
<span class="eqno">(3.12)<a class="headerlink" href="#equation-h0-12" title="Permalink to this equation">#</a></span>\[
\ddot{z}(t) + 2\,\omega_0\,\xi\,\dot{z}(t) + \omega_0^2\,z(t) = -\ddot{u}_g(t)
\]</div>
<div class="note admonition">
<p class="admonition-title">The natural period of buildings</p>
<p>As a rule of thumb, we note that the the natural period of building is roughly propotional to the the number of floors <span class="math notranslate nohighlight">\(n\)</span> in the building. Indeed, considering <span class="math notranslate nohighlight">\(h_0=n\,\Delta h\)</span> anmd <span class="math notranslate nohighlight">\(m=n\,\Delta m\)</span> with <span class="math notranslate nohighlight">\(\Delta h\)</span> and <span class="math notranslate nohighlight">\(\Delta m\)</span> being the height and the mass of each floors, we obtain</p>
<div class="math notranslate nohighlight" id="equation-h0-13">
<span class="eqno">(3.13)<a class="headerlink" href="#equation-h0-13" title="Permalink to this equation">#</a></span>\[
T_0 = 2\,\pi\,\sqrt{\frac{m}{k}} = n\,\delta T
\]</div>
<p>with <span class="math notranslate nohighlight">\(\delta T\)</span> being the natural period of each floor</p>
<div class="math notranslate nohighlight" id="equation-h0-14">
<span class="eqno">(3.14)<a class="headerlink" href="#equation-h0-14" title="Permalink to this equation">#</a></span>\[
\delta T=2\,\pi\,\sqrt{\frac{\delta m}{\delta h}}
\]</div>
<p>In contrast, it can checked that the damping ratio <span class="math notranslate nohighlight">\(\xi\)</span> does not vary with the number of floors and it usually ranges from <span class="math notranslate nohighlight">\(0.05\)</span> to <span class="math notranslate nohighlight">\(0.1\)</span> (or, in the woording of the  engineers, from <span class="math notranslate nohighlight">\(5\%\)</span> to <span class="math notranslate nohighlight">\(10%\)</span>).</p>
</div>
<div class="note admonition">
<p class="admonition-title">Relative or total acceleration?</p>
<p>As shown by eqs. <a class="reference internal" href="#equation-h0-6">(3.6)</a> and <a class="reference internal" href="#equation-h0-12">(3.12)</a>, both the relative motion of the seismometer and of the building are governed by the same differential equation, having the minus ground acceleration as the driven term. When we will discuss the seismometer, we will focus on the link betweem the ground and the relative motions as the former and the latter are what we want retrive and can measure, respectively. When we will discuss the building, instead, we will be more interested in quantifying the total acceleration to which it is subjected, and we will recover it as the sum of the ground and relative acceleration.</p>
</div>
</div>
</section>
</section>
<section id="damped-harmonic-oscillator">
<h2><a class="toc-backref" href="#id4"><span class="section-number">3.2. </span>Damped Harmonic oscillator</a><a class="headerlink" href="#damped-harmonic-oscillator" title="Permalink to this headline">#</a></h2>
<div class="full-width docutils">
<p>The damped harmonic oscillator is a classic problem in mechanics. It describes the movement of a mechanical oscillator (e.g. spring pendulum) under the influence of a restoring force and friction. Let us thus set to zero the ground motion acceletarion and solve the homogenous differential equation with specified initial condition on the position and velocity at time = <span class="math notranslate nohighlight">\(t=0\)</span></p>
<div class="math notranslate nohighlight">
\[
\ddot{z}_\mathrm{h}(t) + 2\,\omega_0\,\xi\,\dot{z}_\mathrm{h}(t) + \omega_0^2\,z_\mathrm{h}(t) = 0
\]</div>
<div class="math notranslate nohighlight" id="equation-h0-15">
<span class="eqno">(3.15)<a class="headerlink" href="#equation-h0-15" title="Permalink to this equation">#</a></span>\[
z_\mathrm{h}(0) = u_0
\qquad
\dot{z}_\mathrm{h}(0) = v_0
\]</div>
<p>The homogeneous solution can be found starting from this trial form</p>
<div class="math notranslate nohighlight" id="equation-h0-16">
<span class="eqno">(3.16)<a class="headerlink" href="#equation-h0-16" title="Permalink to this equation">#</a></span>\[
z_\mathrm{h}(t) = Z_+\,e^{\gamma_+\,t} + Z_-\,e^{\gamma_-\,t}
\]</div>
<p>and it is straigforwad to show that the two exponents <span class="math notranslate nohighlight">\(\gamma_\pm\)</span> are the solution of a degree-2 polynomial</p>
<div class="math notranslate nohighlight" id="equation-h0-17">
<span class="eqno">(3.17)<a class="headerlink" href="#equation-h0-17" title="Permalink to this equation">#</a></span>\[
Z_\pm\,\big(\gamma_\pm^2+2\,\omega_0\,\xi\,\gamma_\pm + \omega_0\big)\,e^{\gamma_\pm\,t} = 0
\]</div>
<p>and read</p>
<div class="math notranslate nohighlight" id="equation-h0-18">
<span class="eqno">(3.18)<a class="headerlink" href="#equation-h0-18" title="Permalink to this equation">#</a></span>\[
\gamma_\pm = -\omega_0\,\xi \pm \omega_0\,\sqrt{\xi^2-1}
\]</div>
</div>
<section id="underdamped-harmonic-oscillator">
<h3><a class="toc-backref" href="#id5"><span class="section-number">3.2.1. </span>Underdamped harmonic oscillator</a><a class="headerlink" href="#underdamped-harmonic-oscillator" title="Permalink to this headline">#</a></h3>
<div class="full-width docutils">
<p>Within the assumption that <span class="math notranslate nohighlight">\(\xi&lt;1\)</span>, the square root in the right-hand side of eq. <a class="reference internal" href="#equation-h0-18">(3.18)</a> is imaginary and the two exponents can be rewritten as folllows</p>
<div class="math notranslate nohighlight" id="equation-h0-19">
<span class="eqno">(3.19)<a class="headerlink" href="#equation-h0-19" title="Permalink to this equation">#</a></span>\[
\gamma_\pm = -\lambda \pm i\,\omega_d
\]</div>
<p>with</p>
<div class="math notranslate nohighlight" id="equation-h0-20">
<span class="eqno">(3.20)<a class="headerlink" href="#equation-h0-20" title="Permalink to this equation">#</a></span>\[
\lambda = \omega_0\,\xi \qquad
\omega_d = \omega_0\,\sqrt{1-\xi^2}
\]</div>
<p>In view of the fact that the real parts of the two exponents coincide, we can recast eq. <a class="reference internal" href="#equation-h0-16">(3.16)</a> as follows</p>
<div class="math notranslate nohighlight" id="equation-h0-21">
<span class="eqno">(3.21)<a class="headerlink" href="#equation-h0-21" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{align}
z_\mathrm{h}(t) &amp;= \big(Z_+\,e^{i\,\omega_d\,t} + Z_-\,e^{-i\,\omega_d\,t}\big)\,e^{-\lambda\,t} \\
                &amp;= \big(C\,\cos(\omega_d\,t) + S\,\sin(\omega_d\,t)\big)\,e^{-\lambda\,t}
\end{align}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(S\)</span> are two constants of integration related to the former by</p>
<div class="math notranslate nohighlight" id="equation-h0-22">
<span class="eqno">(3.22)<a class="headerlink" href="#equation-h0-22" title="Permalink to this equation">#</a></span>\[
C = Z_+ + Z_-   \qquad
S=i\,\big(Z_+ - Z_-\big)
\]</div>
<p>In light of this, the assumption of  <span class="math notranslate nohighlight">\(\xi&lt;1\)</span> leads to underdamped oscillations: the system oscillates (with a slightly different frequency than the natural frequency) with the amplitude gradually decreasing to zero. The angular frequency of the underdamped harmonic oscillator is <span class="math notranslate nohighlight">\(\omega_d\)</span>  and the exponential decay of the underdamped harmonic oscillator is <span class="math notranslate nohighlight">\(\lambda\)</span>. In light of this, the homogeneous solution of the harmonic oscillator can be seen as a transient response with an exponential decay.</p>
<p>The cases <span class="math notranslate nohighlight">\(\xi=1\)</span> and <span class="math notranslate nohighlight">\(\xi&gt;1\)</span>, instead, describe critical and overdamped oscillations. They are not relevant in seismology and we do not discuss them.</p>
</div>
</section>
<section id="initial-conditions">
<h3><a class="toc-backref" href="#id6"><span class="section-number">3.2.2. </span>Initial conditions</a><a class="headerlink" href="#initial-conditions" title="Permalink to this headline">#</a></h3>
<div class="full-width docutils">
<p>Considering the first order derivative of eq. <a class="reference internal" href="#equation-h0-21">(3.21)</a></p>
<div class="math notranslate nohighlight" id="equation-h0-23">
<span class="eqno">(3.23)<a class="headerlink" href="#equation-h0-23" title="Permalink to this equation">#</a></span>\[
\dot{z}_\mathrm{h}(t) = \big[-(C\,\omega_d+S\,\lambda)\,\sin(\omega_d\,t) + (S\,\omega_d-C\,\lambda)\,\cos(\omega_d\,t)\big]\,e^{-\lambda\,t} 
\]</div>
<p>from eq. <a class="reference internal" href="#equation-h0-15">(3.15)</a> we have</p>
<div class="math notranslate nohighlight" id="equation-h0-24">
<span class="eqno">(3.24)<a class="headerlink" href="#equation-h0-24" title="Permalink to this equation">#</a></span>\[
z_\mathrm{h}(0)  = C  = u_0
\qquad \dot{z}_\mathrm{h}(0)  = S\,\omega_d - C\,\lambda  = v_0
\]</div>
<p>This system of equations is solved by</p>
<div class="math notranslate nohighlight" id="equation-h0-25">
<span class="eqno">(3.25)<a class="headerlink" href="#equation-h0-25" title="Permalink to this equation">#</a></span>\[
C = u_0 \qquad 
S = \frac{u_0\,\lambda + v_0}{\omega_d} 
\]</div>
<p>and the transient response, eq. <a class="reference internal" href="#equation-h0-21">(3.21)</a>, and its derivatives become</p>
<div class="math notranslate nohighlight" id="equation-h0-26">
<span class="eqno">(3.26)<a class="headerlink" href="#equation-h0-26" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{align}
&amp; z_\mathrm{h}(t) = \left(u_0\,\cos(\omega_d\,t) +\frac{u_0\,\lambda  + v_0}{\omega_d}  \,\sin(\omega_d\,t)\right)\,e^{-\lambda\,t}
\\
&amp; \dot{z}_\mathrm{h}(t) = \left(v_0  \,\cos(\omega_d\,t) - \frac{u_0\,\omega_0^2  + v_0\,\lambda}{\omega_d}\,\sin(\omega_d\,t)\right)\,e^{-\lambda\,t}
\\
&amp;\ddot{z}_\mathrm{h}(t) = \left[a_0\,\,\cos(\omega_d\,t)-\frac{v_0\,\omega_0^2 + a_0\,\lambda }{\omega_d}  \,\sin(\omega_d\,t)\right]\,e^{-\lambda\,t}
\end{align}
\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(a_0\)</span> being the initial acceleration</p>
<div class="math notranslate nohighlight" id="equation-h0-27">
<span class="eqno">(3.27)<a class="headerlink" href="#equation-h0-27" title="Permalink to this equation">#</a></span>\[
a_0 = -\big(u_0\,\omega_0^2  + 2\,v_0\,\lambda\big)
\]</div>
</div>
<div class="full-width docutils">
<p>Eq. <a class="reference internal" href="#equation-h0-26">(3.26)</a> is implemented by the function <code class="docutils literal notranslate"><span class="pre">damped_harmonic_oscillator</span></code> of the <code class="docutils literal notranslate"><span class="pre">theory</span></code> module that we can use for compunting the transient response</p>
</div>
<div class="cell tag_full-width tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">theory</span> <span class="kn">import</span> <span class="n">damped_harmonic_oscillator</span>
<span class="n">help</span><span class="p">(</span><span class="n">damped_harmonic_oscillator</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function damped_harmonic_oscillator in module theory:

damped_harmonic_oscillator(ts, U, V, natural_period=1, damping_ratio=0.1)
    
    Return the `transient_motions` (displacement, velocity, and acceleration)
    of a damped harmonic oscillator evaluated  at the times `ts` with  
    displacement `U` and velocity `V` as initial conditions. 
    
    The natural period and damping ratio can be set as optional arguments.
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<p>and we plot them for different choises of the initial conditions</p>
</div>
<div class="cell tag_hide-input tag_full-width docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10001</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">U</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">relative_motions</span> <span class="o">=</span> <span class="n">damped_harmonic_oscillator</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span><span class="n">relative_motion</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span><span class="n">relative_motions</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">relative_motion</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;U = &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">U</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; m&quot;</span><span class="p">)</span>

<span class="n">U</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">6</span>
<span class="n">relative_motions</span> <span class="o">=</span> <span class="n">damped_harmonic_oscillator</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span><span class="n">relative_motion</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span><span class="n">relative_motions</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">relative_motion</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;V = &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; m/s&quot;</span><span class="p">)</span>

<span class="n">ylabels</span><span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Displacement [m]&quot;</span><span class="p">,</span> <span class="s2">&quot;Velocity [m/s]&quot;</span><span class="p">,</span> <span class="s2">&quot;Acceleration [m/s$^2$]&quot;</span><span class="p">]</span>

<span class="n">options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ylabel</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">):</span>
    <span class="n">ylim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">ylim</span><span class="p">,</span><span class="n">ylim</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<figure class="align-default" id="fig-transient">
<div class="cell_output docutils container">
<img alt="../_images/C0_Harmonic_6_0.png" src="../_images/C0_Harmonic_6_0.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 3.3 </span><span class="caption-text">Transient response (displacement, velocity and acceleration) of the damped harmonic oscillator, eq. <a class="reference internal" href="#equation-h0-26">(3.26)</a>, with initial conditions <span class="math notranslate nohighlight">\(u_0=1\)</span> m and <span class="math notranslate nohighlight">\(v_0=0\)</span> m/s (blue line), and <span class="math notranslate nohighlight">\(u_0=0\)</span> m and <span class="math notranslate nohighlight">\(v_0=6\)</span> m/s (orange line). The natural period and damping ratio of the harmonic oscillator are <span class="math notranslate nohighlight">\(T=1\)</span> s and <span class="math notranslate nohighlight">\(\xi=0.1\)</span>.</span><a class="headerlink" href="#fig-transient" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
</section>
</section>
<section id="general-solution">
<h2><a class="toc-backref" href="#id7"><span class="section-number">3.3. </span>General solution</a><a class="headerlink" href="#general-solution" title="Permalink to this headline">#</a></h2>
<div class="full-width docutils">
<p>In view of the fact that the differential equation of the driven harmonic oscillator is linear in both <span class="math notranslate nohighlight">\(z\)</span> and <span class="math notranslate nohighlight">\(u\)</span> and their derivatives, its general solution, for any ground acceleration, can be expressed in the following form of a time convolution</p>
<div class="math notranslate nohighlight" id="equation-h0-28">
<span class="eqno">(3.28)<a class="headerlink" href="#equation-h0-28" title="Permalink to this equation">#</a></span>\[
z(t) = \int_{-\infty}^\infty \ddot{u}_g(\tau)\,G(t-\tau)\,d\tau
\]</div>
<p>between the ground acceleration and a Green function <span class="math notranslate nohighlight">\(G\)</span> that we are going to determine.</p>
</div>
<section id="green-function">
<h3><a class="toc-backref" href="#id8"><span class="section-number">3.3.1. </span>Green function</a><a class="headerlink" href="#green-function" title="Permalink to this headline">#</a></h3>
<div class="full-width docutils">
<p>Substituting eq. <a class="reference internal" href="#equation-h0-28">(3.28)</a> into eq. <a class="reference internal" href="#equation-h0-6">(3.6)</a> or <a class="reference internal" href="#equation-h0-12">(3.12)</a> we obtain</p>
<div class="math notranslate nohighlight" id="equation-h0-29">
<span class="eqno">(3.29)<a class="headerlink" href="#equation-h0-29" title="Permalink to this equation">#</a></span>\[
\int_{-\infty}^\infty \ddot{u}_g(\tau)\,\big(\ddot{G}(t-\tau)+2\,\lambda\,\dot{G}(t-\tau)+\omega_0^2\,G(t-\tau)\big)\,d\tau = -\ddot{u}_g(t)
\]</div>
<p>From this point of view, we can understand that we are looking for a Green function <span class="math notranslate nohighlight">\(G\)</span> such that</p>
<div class="math notranslate nohighlight" id="equation-h0-30">
<span class="eqno">(3.30)<a class="headerlink" href="#equation-h0-30" title="Permalink to this equation">#</a></span>\[
\ddot{G}(t)+2\,\lambda\,\dot{G}(t)+\omega_0^2\,G(t) = - \delta(t)
\]</div>
<p>In this perspective, we test the following trial solution</p>
<div class="math notranslate nohighlight" id="equation-h0-31">
<span class="eqno">(3.31)<a class="headerlink" href="#equation-h0-31" title="Permalink to this equation">#</a></span>\[
G(t) = f(t)\,H(t)
\]</div>
<p>with <span class="math notranslate nohighlight">\(f\)</span> satisfying the following initial conditions</p>
<div class="math notranslate nohighlight" id="equation-h0-32">
<span class="eqno">(3.32)<a class="headerlink" href="#equation-h0-32" title="Permalink to this equation">#</a></span>\[
f(0) = 0 \qquad \dot{f}(0) = -1
\]</div>
<p>These initial conditions have been defined in such a way that</p>
<div class="math notranslate nohighlight" id="equation-h0-33">
<span class="eqno">(3.33)<a class="headerlink" href="#equation-h0-33" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{align}
&amp; \dot{G}(t) = \dot{f}(t)\,H(t) + f(0)\,\delta(t) =  \dot{f}(t)\,H(t)
\\
&amp; \ddot{G}(t) = \ddot{f}(t)\,H(t) + \dot{f}(0)\,\delta(t) = \ddot{f}(t)\,H(t) -\delta(t)  
\end{align}
\end{split}\]</div>
<p>and, so, eq. <a class="reference internal" href="#equation-h0-30">(3.30)</a> simplifies into</p>
<div class="math notranslate nohighlight" id="equation-h0-34">
<span class="eqno">(3.34)<a class="headerlink" href="#equation-h0-34" title="Permalink to this equation">#</a></span>\[
\big(\ddot{f}(t)+2\,\lambda\,\dot{f}(t)+\omega_0^2\,f(t)\big)\,H(t) = 0
\]</div>
<p>In this respect, <span class="math notranslate nohighlight">\(f\)</span> is the homoegenous solution for the harmonic oscillator with initial conditions given by eq. <a class="reference internal" href="#equation-h0-32">(3.32)</a>. From eq. <a class="reference internal" href="#equation-h0-26">(3.26)</a> we thus obtain</p>
<div class="math notranslate nohighlight" id="equation-h0-35">
<span class="eqno">(3.35)<a class="headerlink" href="#equation-h0-35" title="Permalink to this equation">#</a></span>\[
f(t) = -\frac{\sin(\omega_d\,t)\,e^{-\lambda\,t}}{\omega_d}
\]</div>
<p>and the Green function becomes</p>
<div class="math notranslate nohighlight" id="equation-h0-35bis">
<span class="eqno">(3.36)<a class="headerlink" href="#equation-h0-35bis" title="Permalink to this equation">#</a></span>\[
G(t) = -\frac{\sin(\omega_d\,t)\,e^{-\lambda\,t}}{\omega_d}\,H(t)
\]</div>
</div>
</section>
<section id="response-function">
<h3><a class="toc-backref" href="#id9"><span class="section-number">3.3.2. </span>Response function</a><a class="headerlink" href="#response-function" title="Permalink to this headline">#</a></h3>
<div class="full-width docutils">
<p>Starting from the Green function, eqs. <a class="reference internal" href="#equation-h0-31">(3.31)</a> and <a class="reference internal" href="#equation-h0-35">(3.35)</a>, we can also obtain the response function <span class="math notranslate nohighlight">\(R\)</span> relating the ground and relative accelerations</p>
<div class="math notranslate nohighlight" id="equation-h0-36">
<span class="eqno">(3.37)<a class="headerlink" href="#equation-h0-36" title="Permalink to this equation">#</a></span>\[
\ddot{z}(t) = \int_{-\infty}^\infty \ddot{u}_g(\tau)\,\ddot{G}(t-\tau)\,d\tau = \int_{-\infty}^\infty \ddot{u}_g(\tau)\,R(t-\tau)\,d\tau
\]</div>
<p>that is the second order derivative of <span class="math notranslate nohighlight">\(G\)</span></p>
<div class="math notranslate nohighlight" id="equation-h0-37">
<span class="eqno">(3.38)<a class="headerlink" href="#equation-h0-37" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{align}
R(t) &amp;= \ddot{G}(t) = \ddot{f}(t)\,H(t) -\delta(t)
\\
&amp;= \left[ \frac{\omega_d^2-\lambda^2}{\omega_d}\,\sin(\omega_d\,t) +2\,\lambda\,\cos(\omega_d\,t)\right]\,e^{-\lambda\,t}\,H(t) - \delta(t)
\end{align}
\end{split}\]</div>
<p>It is straightforward to show that the response function also relates the ground and relative displacements, as well as the ground and relative velocities</p>
<div class="math notranslate nohighlight" id="equation-h0-38">
<span class="eqno">(3.39)<a class="headerlink" href="#equation-h0-38" title="Permalink to this equation">#</a></span>\[
z(t) = \int_{-\infty}^\infty u_g(\tau)\,R(t-\tau)\,d\tau
\qquad
\dot{z}(t) = \int_{-\infty}^\infty \dot{u}_g(\tau)\,R(t-\tau)\,d\tau
\]</div>
<p>Although the Green and response functions allow to determine the relative ground motion, their application requires a time convolution that can be tedious to be computed analytically and hide the physical understanding of the problem. We will use them in the frequency domain after <a class="reference internal" href="C1_Fourier.html#chap-f"><span class="std std-ref">Fourier transform</span></a> and to make practise on the <a class="reference internal" href="C2_Discrete.html#chap-d"><span class="std std-ref">Discrete Fourier transform</span></a>.</p>
</div>
</section>
</section>
<section id="sinusoidal-ground-acceleration">
<h2><a class="toc-backref" href="#id10"><span class="section-number">3.4. </span>Sinusoidal ground acceleration</a><a class="headerlink" href="#sinusoidal-ground-acceleration" title="Permalink to this headline">#</a></h2>
<div class="full-width docutils">
<p>In order to understand how the harmonic oscillator behaves when driven by ground motion, let us consider the following ground acceleration with period <span class="math notranslate nohighlight">\(T_g\)</span></p>
<div class="math notranslate nohighlight" id="equation-h0-39">
<span class="eqno">(3.40)<a class="headerlink" href="#equation-h0-39" title="Permalink to this equation">#</a></span>\[
\ddot{u}_g = g(t)\,H(t)
\]</div>
<p>where <span class="math notranslate nohighlight">\(g\)</span> is a monochromatic signal with angular frequency <span class="math notranslate nohighlight">\(\omega_g\)</span> and phase <span class="math notranslate nohighlight">\(\phi_g\)</span></p>
<div class="math notranslate nohighlight" id="equation-h0-40">
<span class="eqno">(3.41)<a class="headerlink" href="#equation-h0-40" title="Permalink to this equation">#</a></span>\[
g(t) = A_g\,\sin(x) \qquad x=\omega_g\,t+\phi_g \qquad
\omega_g = \frac{2\,\pi}{T_g}
\]</div>
<p>Let us implement eqs. <a class="reference internal" href="#equation-h0-39">(3.40)</a> and <a class="reference internal" href="#equation-h0-40">(3.41)</a> in python</p>
</div>
<div class="cell tag_full-width tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">eva_sinusoidal_acceleration</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">Tg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ground_phase</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    
    <span class="n">wg</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">Tg</span>
    
    <span class="n">x</span> <span class="o">=</span> <span class="n">wg</span><span class="o">*</span><span class="n">ts</span> <span class="o">+</span>  <span class="n">ground_phase</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ground_acceleration</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">ground_acceleration</span><span class="p">[</span><span class="n">ts</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">ground_acceleration</span><span class="p">,</span> <span class="n">g</span>
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<p>and plot the ground acceleration and the monochromatic signal</p>
</div>
<div class="cell tag_full-width tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Tg</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">Tg</span><span class="p">,</span><span class="mi">5</span><span class="o">*</span><span class="n">Tg</span><span class="p">,</span><span class="mi">10001</span><span class="p">)</span>
<span class="n">ground_acceleration</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">eva_sinusoidal_acceleration</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">Tg</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">ground_acceleration</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Acceleration [m/s$^2$]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<figure class="align-default" id="fig-sinusoidal">
<div class="cell_output docutils container">
<img alt="../_images/C0_Harmonic_15_0.png" src="../_images/C0_Harmonic_15_0.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 3.4 </span><span class="caption-text">Sinusoidal ground acceleratio <span class="math notranslate nohighlight">\(u_g\)</span> (blue line, eq. <a class="reference internal" href="#equation-h0-39">(3.40)</a>) and the associated monochromatic signal <span class="math notranslate nohighlight">\(g\)</span> (orange dashed line, eq. <a class="reference internal" href="#equation-h0-40">(3.41)</a>)  for  <span class="math notranslate nohighlight">\(T_g=1\)</span> s, <span class="math notranslate nohighlight">\(\phi_g=0\)</span> and <span class="math notranslate nohighlight">\(A_g=1\)</span> m/s<span class="math notranslate nohighlight">\(^2\)</span>.</span><a class="headerlink" href="#fig-sinusoidal" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<div class="full-width docutils">
<p>As we are going to verify, the relative motion can be expressed in the following form</p>
<div class="math notranslate nohighlight" id="equation-h0-41">
<span class="eqno">(3.42)<a class="headerlink" href="#equation-h0-41" title="Permalink to this equation">#</a></span>\[
z(t) = \big(z_\mathrm{p}(t) + z_\mathrm{h}(t)\big)\,H(t) 
\]</div>
<p>where <span class="math notranslate nohighlight">\(z_\mathrm{h}\)</span> is an homogeneous solution and <span class="math notranslate nohighlight">\(z_\mathrm{p}\)</span> is a particular solution of the harmonic oscillator driven by the monochromatic signal</p>
<div class="math notranslate nohighlight" id="equation-h0-42">
<span class="eqno">(3.43)<a class="headerlink" href="#equation-h0-42" title="Permalink to this equation">#</a></span>\[
\ddot{z}_p(t)+2\,\lambda\,\dot{z}_p(t)+\omega_0\,z_\mathrm{p}(t) = -g(t)
\]</div>
<p>Here the Heaviside function <span class="math notranslate nohighlight">\(H\)</span> has been introduced because there is no motion before the beginning of the ground motion and it affects the first and second order derivatives as follow</p>
<div class="math notranslate nohighlight" id="equation-h0-43">
<span class="eqno">(3.44)<a class="headerlink" href="#equation-h0-43" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{align}
&amp;\dot{z}(t) = (\dot{z}_\mathrm{p}(t)+\dot{z}_\mathrm{h}(t))\,H + (z_\mathrm{p}(t)+z_\mathrm{h}(t))\,\delta(t)
\\
&amp;\ddot{z}(t) = (\ddot{z}_\mathrm{p}(t)+\ddot{z}_\mathrm{h}(t))\,H + 2\,(\dot{z}_\mathrm{p}(t)+\dot{z}_\mathrm{h}(t))\,\delta(t) + (z_p+z_h)\,\dot{\delta}(t)
\end{align}
\end{split}\]</div>
<p>Once substituded in eq. <a class="reference internal" href="#equation-h0-6">(3.6)</a>, we obtain</p>
<div class="math notranslate nohighlight" id="equation-h0-44">
<span class="eqno">(3.45)<a class="headerlink" href="#equation-h0-44" title="Permalink to this equation">#</a></span>\[
2\,(\dot{z}_\mathrm{p}(t)+\dot{z}_\mathrm{h}(t))\,\delta(t) + (z_\mathrm{p}(t)+z_\mathrm{h}(t))\,\dot{\delta}(t) + 2\,\lambda\,(z_\mathrm{p}(t)+z_\mathrm{h}(t))\,\delta(t) = 0
\]</div>
<p>Within this framework, we can understand that eq. <a class="reference internal" href="#equation-h0-41">(3.42)</a> solves eq. <a class="reference internal" href="#equation-h0-6">(3.6)</a> before and after the initial time, within the time intervals <span class="math notranslate nohighlight">\((-\infty,0)\)</span> and <span class="math notranslate nohighlight">\((0,\infty)\)</span>.  In order that it solve the differential equation also in the surrounding of the initial time <span class="math notranslate nohighlight">\(t=0\)</span>, we need to choose the homogeneous solution in such a way that <span class="math notranslate nohighlight">\(z\)</span> and its first derivative are continuous at <span class="math notranslate nohighlight">\(t=0\)</span>, which means that we have to require that</p>
<div class="math notranslate nohighlight" id="equation-h0-45">
<span class="eqno">(3.46)<a class="headerlink" href="#equation-h0-45" title="Permalink to this equation">#</a></span>\[
z_\mathrm{p}(0)+z_\mathrm{h}(0) = 0 \qquad \dot{z}_\mathrm{p}(0) +\dot{z}_\mathrm{h}(0) = 0
\]</div>
<p>We can fullfil this requirement by setting the initial displacement and velocity for the homoegenous solution have to be choosen as follows</p>
<div class="math notranslate nohighlight" id="equation-h0-46">
<span class="eqno">(3.47)<a class="headerlink" href="#equation-h0-46" title="Permalink to this equation">#</a></span>\[
u_0 = -z_\mathrm{p}(0)  \qquad v_0 = -\dot{z}_\mathrm{p}(0) 
\]</div>
</div>
<div class="note full-width admonition">
<p class="admonition-title">Transient and steady-state solutions</p>
<p>Although we have not yet determined <span class="math notranslate nohighlight">\(z_\mathrm{p}\)</span> and <span class="math notranslate nohighlight">\(z_\mathrm{h}\)</span>, we can already state that the latter describes a transient response of which the amplitude gradually decreases to zero with the exponential decay <span class="math notranslate nohighlight">\(\lambda\)</span>. The former, instead, describes the steady state solution that persists and will be the only one after the initial transient.</p>
</div>
<section id="particular-or-steady-state-solution">
<h3><a class="toc-backref" href="#id11"><span class="section-number">3.4.1. </span>Particular (or steady state) solution</a><a class="headerlink" href="#particular-or-steady-state-solution" title="Permalink to this headline">#</a></h3>
<div class="full-width docutils">
<p>Let us solve eq. <a class="reference internal" href="#equation-h0-42">(3.43)</a> starting from the following trial solution</p>
<div class="math notranslate nohighlight" id="equation-h0-47">
<span class="eqno">(3.48)<a class="headerlink" href="#equation-h0-47" title="Permalink to this equation">#</a></span>\[
z_p(t) = - A_g\,\frac{\rho\,\sin(x+\phi)}{\omega_g^2}
\]</div>
<p>The relative velocity and acceleration read</p>
<div class="math notranslate nohighlight" id="equation-h0-48">
<span class="eqno">(3.49)<a class="headerlink" href="#equation-h0-48" title="Permalink to this equation">#</a></span>\[
\dot{z}_p(t) = - A_g\,\frac{\rho\,\cos(x+\phi)}{\omega_g}
\qquad \ddot{z}(t) = A_g\,\rho\,\sin(x+\phi) 
\]</div>
<p>and, so, <span class="math notranslate nohighlight">\(\rho\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span> can be considered as the amplitude factor and phase shift of the relative acceleration with respect to the ground acceleration.</p>
<p>Substituting eqs. <a class="reference internal" href="#equation-h0-47">(3.48)</a> and <a class="reference internal" href="#equation-h0-48">(3.49)</a> into eq. <a class="reference internal" href="#equation-h0-6">(3.6)</a>, making use of the following trigognometric identities</p>
<div class="math notranslate nohighlight" id="equation-h0-49">
<span class="eqno">(3.50)<a class="headerlink" href="#equation-h0-49" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{align}
\sin(x+\phi) = \sin x\,\cos\phi + \cos x\,\sin\phi
\\
\cos(x+\phi) = \sin x\,\sin\phi - \cos x\,\cos\phi
\end{align}
\end{split}\]</div>
<p>and collecting the sine, <span class="math notranslate nohighlight">\(\sin x\)</span>, and cosine, <span class="math notranslate nohighlight">\(\cos x\)</span>, terms, we obtain</p>
<div class="math notranslate nohighlight" id="equation-h0-50">
<span class="eqno">(3.51)<a class="headerlink" href="#equation-h0-50" title="Permalink to this equation">#</a></span>\[
-\frac{\rho}{\omega_g^2}\,\left[\cos x\,\Big(\big(\omega_0^2-\omega_g^2\big)\,\sin\phi + 2\,\omega_g\,\lambda\,\cos\phi\Big)
+\sin x\,\Big(\big(\omega_0^2-\omega_g^2\big)\,\cos\phi - 2\,\omega_g\,\lambda\,\sin\phi\Big)\right] = - \sin x 
\]</div>
<p>Just because the right-hand side is characterized by the only sine term, the factor of <span class="math notranslate nohighlight">\(\cos x\)</span> in left-hand side have to be zero and we can do it choosing</p>
<div class="math notranslate nohighlight" id="equation-h0-51">
<span class="eqno">(3.52)<a class="headerlink" href="#equation-h0-51" title="Permalink to this equation">#</a></span>\[
\cos\phi = \frac{\omega_0^2-\omega_g^2}{D} \qquad \sin\phi = \frac{-2\,\omega_g\,\lambda}{D}  \qquad \mathrm{with}\qquad
D = \sqrt{\big(\omega_0^2-\omega_g^2)^2+(2\,\omega_g\,\lambda)^2}
\]</div>
<p>With this choice, eq. <a class="reference internal" href="#equation-h0-50">(3.51)</a> becomes</p>
<div class="math notranslate nohighlight" id="equation-h0-52">
<span class="eqno">(3.53)<a class="headerlink" href="#equation-h0-52" title="Permalink to this equation">#</a></span>\[
-\frac{\rho}{\omega_g^2}\,\sin x\,D = - \sin x
\]</div>
<p>that is satisfied by</p>
<div class="math notranslate nohighlight" id="equation-h0-53">
<span class="eqno">(3.54)<a class="headerlink" href="#equation-h0-53" title="Permalink to this equation">#</a></span>\[
\rho=\frac{\omega_g^2}{D}
\]</div>
<div class="note admonition">
<p class="admonition-title">Resonance frequency</p>
<p>Let us investigate the frequency at which the amplitude factor <span class="math notranslate nohighlight">\(\rho\)</span> reaches its maximum value. By investigating the stationary points</p>
<div class="math notranslate nohighlight" id="equation-h0-54">
<span class="eqno">(3.55)<a class="headerlink" href="#equation-h0-54" title="Permalink to this equation">#</a></span>\[
\frac{\partial \rho}{\partial \omega_g} = \frac{2\,\omega_g\,\omega_0^2}{D^3}\,\big[\omega_0^2-\omega_g^2\,\big(1-2\,\xi^2\big)\big]
\]</div>
<p>we found that <span class="math notranslate nohighlight">\(\omega_g=0\)</span> is a minimum, while</p>
<div class="math notranslate nohighlight" id="equation-h0-55">
<span class="eqno">(3.56)<a class="headerlink" href="#equation-h0-55" title="Permalink to this equation">#</a></span>\[
\omega_g = \omega_0\,\sqrt{1-2\,\xi^2}
\]</div>
<p>is a maximum. The latter, however, there exists only when <span class="math notranslate nohighlight">\(\xi&lt;1/\sqrt{2}\approx 0.707\)</span>.</p>
</div>
</div>
<div class="full-width docutils">
<p>Eqs. <a class="reference internal" href="#equation-h0-47">(3.48)</a> and <a class="reference internal" href="#equation-h0-48">(3.49)</a> are implemented by the functions <code class="docutils literal notranslate"><span class="pre">setup_harmonic_oscilator</span></code> and <code class="docutils literal notranslate"><span class="pre">driven_sinusoidal_oscillator</span></code> of the <code class="docutils literal notranslate"><span class="pre">theory</span></code> module that we can use for compunting the steady state relative motion due to the sinusoidal ground acceleration</p>
</div>
<div class="cell tag_full-width tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">theory</span> <span class="kn">import</span> <span class="n">setup_harmonic_oscillator</span><span class="p">,</span> <span class="n">steadystate_driven_oscillator</span>

<span class="n">help</span><span class="p">(</span><span class="n">setup_harmonic_oscillator</span><span class="p">)</span>
<span class="n">help</span><span class="p">(</span><span class="n">steadystate_driven_oscillator</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function setup_harmonic_oscillator in module theory:

setup_harmonic_oscillator(wg, natural_period=1, damping_ratio=0.1)
    
    Return the amplitude factor and the phase shift of a damped harmonic 
    oscillator for the given anuglar frequency wg. By default, the natural 
    period and dampimng ratio of the harmonic oscillator are 1 s and 0.1.

Help on function steadystate_driven_oscillator in module theory:

steadystate_driven_oscillator(ts, Tg=1, ground_phase=0, natural_period=1, damping_ratio=0.1)
    
    Return ground acceleration of given ground period and phase and the
    steady state relative motion (displacement, velocity and acceleration) 
    of an harmonic oscillator evaluated at the times ts.
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<p>and plot the comparison between the ground acceleration and the relative, <span class="math notranslate nohighlight">\(\ddot{z}\)</span>, and total, <span class="math notranslate nohighlight">\(\ddot{u}=\ddot{u}_g+\ddot{z}\)</span>, accelerations for different ground periods</p>
</div>
<div class="cell tag_full-width tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Tgs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]</span>

<span class="n">damping_ratio</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$(\xi=</span><span class="si">{0:&lt;5.3}</span><span class="s2">)$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">damping_ratio</span><span class="p">)</span>

<span class="n">hvline_options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Tgs</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">Tgs</span><span class="p">)),</span> <span class="n">sharey</span><span class="o">=</span><span class="s2">&quot;row&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">axe</span><span class="p">,</span> <span class="n">Tg</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">Tgs</span><span class="p">):</span>
    
    <span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">Tg</span>
    <span class="n">tmax</span> <span class="o">=</span>  <span class="mi">5</span><span class="o">*</span><span class="n">Tg</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="mi">10001</span><span class="p">)</span>
    <span class="n">ground_acceleration</span><span class="p">,</span> <span class="n">relative_motions</span> <span class="o">=</span> <span class="n">steadystate_driven_oscillator</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">Tg</span><span class="p">)</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">axe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">ground_acceleration</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">relative_motions</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;relative&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Acceleration [m/s$^2$]&quot;</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">ground_acceleration</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">ground_acceleration</span><span class="o">+</span><span class="n">relative_motions</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axe</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;T$_g$=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Tg</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; s&quot;</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;RELATIVE &quot;</span><span class="o">+</span><span class="n">label</span><span class="o">+</span><span class="s2">&quot;:  $\ddot</span><span class="si">{z}</span><span class="s2">(t)$&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;TOTAL &quot;</span><span class="o">+</span><span class="n">label</span><span class="o">+</span><span class="s2">&quot;:  $\ddot</span><span class="si">{u}</span><span class="s2">(t) = \ddot</span><span class="si">{z}</span><span class="s2">(t)+\ddot</span><span class="si">{u}</span><span class="s2">_g(t)$&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">hvline_options</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">hvline_options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<figure class="align-default" id="fig-driven-building">
<div class="cell_output docutils container">
<img alt="../_images/C0_Harmonic_24_0.png" src="../_images/C0_Harmonic_24_0.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 3.5 </span><span class="caption-text">Comparison between the sinusoidal ground acceleration (blue line) and the relative and total accelerations (left and right columns, orange lines) of the driven harmonic oscillator with ground periods <span class="math notranslate nohighlight">\(T_g=5,1.5,1\)</span> and <span class="math notranslate nohighlight">\(0.1\)</span> s (from top to bottom) and the damping ratio set to <span class="math notranslate nohighlight">\(\xi=0.1\)</span>. The natural period of the harmonic oscillator is always set to <span class="math notranslate nohighlight">\(T=1\)</span> s.</span><a class="headerlink" href="#fig-driven-building" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<div class="full-width docutils">
<p>We note that the relative ground acceleration can be amplified or damped with respect to the ground acceleration, as well as shifted in time. In particular, for ground periods much shorter than the natural period of the harmonic oscillator, we have that the relative acceleration is almost opposite to the ground accelaration, resulting into a negligible total accelaration. On the contrary, for ground periods much larger than the natural period, we have that the relative acceleration is negligible, resulting into a total acceleration almost equal to that of the ground.</p>
<p>Let us now consider the case of a damping ratio <span class="math notranslate nohighlight">\(\xi=1/\sqrt{2}\approx 0.707\)</span> and make a similar plot to that shown in <a class="reference internal" href="#fig-building"><span class="std std-numref">Figure 3.2</span></a></p>
</div>
<div class="cell tag_full-width tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">damping_ratio</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$(\xi=</span><span class="si">{0:&lt;5.3}</span><span class="s2">)$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">damping_ratio</span><span class="p">)</span>

<span class="n">hvline_options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Tgs</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">Tgs</span><span class="p">)),</span> <span class="n">sharey</span><span class="o">=</span><span class="s2">&quot;row&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">axe</span><span class="p">,</span> <span class="n">Tg</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">Tgs</span><span class="p">):</span>
    
    <span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">Tg</span>
    <span class="n">tmax</span> <span class="o">=</span>  <span class="mi">5</span><span class="o">*</span><span class="n">Tg</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="mi">10001</span><span class="p">)</span>
    <span class="n">ground_acceleration</span><span class="p">,</span> <span class="n">relative_motions</span> <span class="o">=</span> <span class="n">steadystate_driven_oscillator</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">Tg</span><span class="p">,</span> <span class="n">damping_ratio</span><span class="o">=</span><span class="n">damping_ratio</span><span class="p">)</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">axe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">ground_acceleration</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">relative_motions</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;relative&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Acceleration [m/s$^2$]&quot;</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">ground_acceleration</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">ground_acceleration</span><span class="o">+</span><span class="n">relative_motions</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axe</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;T$_g$=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Tg</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; s&quot;</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;RELATIVE &quot;</span><span class="o">+</span><span class="n">label</span><span class="o">+</span><span class="s2">&quot;:  $\ddot</span><span class="si">{z}</span><span class="s2">(t)$&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;TOTAL &quot;</span><span class="o">+</span><span class="n">label</span><span class="o">+</span><span class="s2">&quot;:  $\ddot</span><span class="si">{u}</span><span class="s2">(t) = \ddot</span><span class="si">{z}</span><span class="s2">(t)+\ddot</span><span class="si">{u}</span><span class="s2">_g(t)$&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">hvline_options</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">hvline_options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<figure class="align-default" id="fig-driven-seismometer">
<div class="cell_output docutils container">
<img alt="../_images/C0_Harmonic_30_0.png" src="../_images/C0_Harmonic_30_0.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 3.6 </span><span class="caption-text">Comparison between the sinusoidal ground acceleration (blue line) and the relative and total accelerations (left and right columns, orange lines) of the driven harmonic oscillator with ground periods <span class="math notranslate nohighlight">\(T_g=5,1.5,1\)</span> and <span class="math notranslate nohighlight">\(0.1\)</span> s (from top to bottom) and the damping ratio set to <span class="math notranslate nohighlight">\(\xi=1/\sqrt{2}\approx 0.707\)</span>. The natural period of the harmonic oscillator is always set to <span class="math notranslate nohighlight">\(T=1\)</span> s.</span><a class="headerlink" href="#fig-driven-seismometer" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<div class="full-width docutils">
<p>In order to have the full picture of the different behavior of the relative acceleration as function of the ground period, we plot here the amplitude factor and phase as function of the ground frequency and for different damping ratios</p>
</div>
<div class="cell tag_hide-input tag_full-width docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="mf">1e1</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">10001</span><span class="p">)</span>
<span class="n">wg</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">fs</span>

<span class="n">fig</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="k">for</span> <span class="n">damping_ratio</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mf">0.95</span><span class="p">]:</span>
    
    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0:&lt;5.3}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">damping_ratio</span><span class="p">)</span>

    <span class="n">amplitude_factor</span><span class="p">,</span> <span class="n">phase</span> <span class="o">=</span> <span class="n">setup_harmonic_oscillator</span><span class="p">(</span><span class="n">wg</span><span class="p">,</span> <span class="n">damping_ratio</span><span class="o">=</span><span class="n">damping_ratio</span><span class="p">)</span>
    <span class="n">phase</span> <span class="o">*=</span> <span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">amplitude_factor</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">45</span><span class="p">,</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">135</span><span class="p">,</span><span class="o">-</span><span class="mi">180</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Amplitude factor $\rho$&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Phase $\phi$ [deg]&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Ground frequency $f_g=1/T_g$ [Hz]&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<figure class="align-default" id="fig-response">
<div class="cell_output docutils container">
<img alt="../_images/C0_Harmonic_37_0.png" src="../_images/C0_Harmonic_37_0.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 3.7 </span><span class="caption-text">Amplitude factor <span class="math notranslate nohighlight">\(\rho\)</span>, eq. <a class="reference internal" href="#equation-h0-53">(3.54)</a>, and phase <span class="math notranslate nohighlight">\(\phi\)</span>, eq. <a class="reference internal" href="#equation-h0-51">(3.52)</a>, as function of the ground frequency for different damping ratios <span class="math notranslate nohighlight">\(\xi=0.1,0.2,0.4,0.707\)</span> and <span class="math notranslate nohighlight">\(0.95\)</span>. The natural period of the harmonic oscillator is always set to <span class="math notranslate nohighlight">\(T=1\)</span> s.</span><a class="headerlink" href="#fig-response" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<div class="full-width docutils">
<p>From this plot, we can understand that at high frequency the amplitude of the relative motion is the same of the ground motion, although shifted by a phase of <span class="math notranslate nohighlight">\(-180^\circ\)</span>, which results thus in <span class="math notranslate nohighlight">\(\ddot{z}_\mathrm{p} = - \ddot{u}_g\)</span>.</p>
</div>
</section>
<section id="transient-response">
<h3><a class="toc-backref" href="#id12"><span class="section-number">3.4.2. </span>Transient response</a><a class="headerlink" href="#transient-response" title="Permalink to this headline">#</a></h3>
<div class="full-width docutils">
<p>Having obtained the particular (steady-state) relative motion, we can now determine the associated transient response with the initial conditions given by eq. <a class="reference internal" href="#equation-h0-46">(3.47)</a> making use of eqs. <a class="reference internal" href="#equation-h0-47">(3.48)</a> and <a class="reference internal" href="#equation-h0-48">(3.49)</a>. In particular, the transient response <span class="math notranslate nohighlight">\(z_\mathrm{h}\)</span> can be obtained from eq. <a class="reference internal" href="#equation-h0-26">(3.26)</a> using</p>
<div class="math notranslate nohighlight" id="equation-h0-56">
<span class="eqno">(3.57)<a class="headerlink" href="#equation-h0-56" title="Permalink to this equation">#</a></span>\[
u_0 = -z_\mathrm{p}(0) = \frac{\rho\,\sin(\phi_g+\phi)}{\omega_g^2} \qquad v_0 = -\dot{z}_\mathrm{p}(0) = \frac{A\,\cos(\phi_g+\phi)}{\omega_g}
\]</div>
<p>as initial conditions.</p>
<p>The steady-state and transient solutions due to the sinusoidal ground acceleration are implemented by the function <code class="docutils literal notranslate"><span class="pre">sinuosidal_driven_oscillator</span></code> of the <code class="docutils literal notranslate"><span class="pre">theory</span></code> module</p>
</div>
<div class="cell tag_full-width tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">theory</span> <span class="kn">import</span> <span class="n">sinusoidal_driven_oscillator</span>

<span class="n">help</span><span class="p">(</span><span class="n">sinusoidal_driven_oscillator</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function sinusoidal_driven_oscillator in module theory:

sinusoidal_driven_oscillator(ts, Tg=1, ground_phase=0, natural_period=1, damping_ratio=0.1)
    
    Return sinusoiudal ground acceleration of given ground period and phase, 
    the steady state relative motion and the transient response (displacement, velocity and acceleration)of 
    an harmonic oscillator evaluated at the times ts.
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<p>and we use it for plotting the comparison between the ground and relative motion, as well as visualize the contribution from the transient motion</p>
</div>
<div class="cell tag_hide-input tag_full-width docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Tg</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">Tg</span>
<span class="n">tmax</span> <span class="o">=</span>  <span class="mi">20</span><span class="o">*</span><span class="n">Tg</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="mi">10001</span><span class="p">)</span>
<span class="n">ground_acceleration</span><span class="p">,</span> <span class="n">relative_motions</span><span class="p">,</span> <span class="n">transient_motions</span> <span class="o">=</span> <span class="n">sinusoidal_driven_oscillator</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">Tg</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">ground_acceleration</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">relative_motions</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;relative&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">transient_motions</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;transient&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Acceleration [m/s$^2$]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<figure class="align-default" id="fig-full">
<div class="cell_output docutils container">
<img alt="../_images/C0_Harmonic_46_0.png" src="../_images/C0_Harmonic_46_0.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 3.8 </span><span class="caption-text">Ground, relative and transient accelerations (blue, orange and green lines) for the driven harmonic oscillator with ground period and phase set to <span class="math notranslate nohighlight">\(T_g=1\)</span> s and <span class="math notranslate nohighlight">\(\phi_g=0\)</span>. The natural period and the damping ratio of the harmonic oscillator are <span class="math notranslate nohighlight">\(T=1\)</span> s and <span class="math notranslate nohighlight">\(\xi=0.1\)</span>.</span><a class="headerlink" href="#fig-full" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
</section>
</section>
<section id="test-function">
<h2><a class="toc-backref" href="#id13"><span class="section-number">3.5. </span>Test function</a><a class="headerlink" href="#test-function" title="Permalink to this headline">#</a></h2>
<div class="full-width docutils">
<p>The sinusoidal ground acceleration, although usefull for a first understanding of the bahaviour of the driven harmonic oscillator, does not describe a typical seismic wave. Considering the ground velocity and displacement, indeed, we have</p>
<div class="math notranslate nohighlight" id="equation-h0-57">
<span class="eqno">(3.58)<a class="headerlink" href="#equation-h0-57" title="Permalink to this equation">#</a></span>\[
\dot{u}_g(t) = \int_{-\infty}^t \ddot{u}_g(\tau)\,d\tau =  H(t)\,A_g\,\int_{0}^t \sin(\omega_g\,\tau+\phi_g)\,d\tau = A_g\,\left(\frac{\cos \phi_g-\cos(\omega_g\,t+\phi_g)}{\omega_g}\right)\,H(t)
\]</div>
<div class="math notranslate nohighlight" id="equation-h0-58">
<span class="eqno">(3.59)<a class="headerlink" href="#equation-h0-58" title="Permalink to this equation">#</a></span>\[
u_g(t) = \int_{-\infty}^t \dot{u}_g(\tau)\,d\tau =  \frac{1}{\omega_g}\,\left(t\,\cos\phi_g-\frac{\sin(\omega_g\,t)}{\omega_g}\right)\,H(t)
\]</div>
<p>and we can see that the ground displacement is characterized by a linear trend beginning at <span class="math notranslate nohighlight">\(t=0\)</span>.</p>
<p>A smooth function that can be used as seismic wavelet packet for describing realistic ground displacement, velocity and acceleration is</p>
<div class="math notranslate nohighlight" id="equation-h0-59">
<span class="eqno">(3.60)<a class="headerlink" href="#equation-h0-59" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{align}
&amp; \ddot{u}_g(t) = A_g\,\big[\cos(\omega_g\,t) - \cos(2\,\omega_g\,t)\big]\,B_{g}(t)
\\
&amp; \dot{u}_g(t) = \frac{A_g}{\omega_g}\,\big[\sin(\omega_g\,t)-\tfrac{1}{2}\,\sin(2\,\omega_g\,t))\big]\,B_{g}(t)
\\
&amp; u_g(t) = \frac{A_g}{\omega_g^2}\,\big[\tfrac{1}{4}\,\cos(2\,\omega_g\,t)-\cos(\omega_g\,t) + \tfrac{3}{4}\big]\,B_{g}(t)
\end{align}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(B_g(t)\)</span> is the box function over the time interal <span class="math notranslate nohighlight">\([0,T_g\)</span>]</p>
<div class="math notranslate nohighlight" id="equation-h0-60">
<span class="eqno">(3.61)<a class="headerlink" href="#equation-h0-60" title="Permalink to this equation">#</a></span>\[
B_{T_g}(t) = H(t) - H(t-T_g)
\]</div>
<p>Eq. <a class="reference internal" href="#equation-h0-59">(3.60)</a> is implemented by the function <code class="docutils literal notranslate"><span class="pre">eva_test_ground_motion</span></code></p>
</div>
<div class="cell tag_full-width tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">theory</span> <span class="kn">import</span> <span class="n">eva_test_ground_motion</span>

<span class="n">help</span><span class="p">(</span><span class="n">eva_test_ground_motion</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function eva_test_ground_motion in module theory:

eva_test_ground_motion(ts, Tg=1)
    
    Return the test ground motion (displacement, velocity and accelarations) defined in eq. (3.59) evaluated at times `ts`
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<p>that we use here for visualize the test ground displacement, velocity and acceleration</p>
</div>
<div class="cell tag_full-width tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Tg</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">Tg</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">Tg</span><span class="p">,</span><span class="mi">10001</span><span class="p">)</span>
<span class="n">ground_motions</span> <span class="o">=</span> <span class="n">eva_test_ground_motion</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">Tg</span><span class="p">)</span>

<span class="n">ylabels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Displacement [m]&quot;</span><span class="p">,</span><span class="s2">&quot;Velocity [m/s]&quot;</span><span class="p">,</span><span class="s2">&quot;Acceleration [m/s$^2$]&quot;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ground_motion</span><span class="p">,</span><span class="n">ylabel</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ground_motions</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">):</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">ground_motion</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<figure class="align-default" id="fig-test">
<div class="cell_output docutils container">
<img alt="../_images/C0_Harmonic_54_0.png" src="../_images/C0_Harmonic_54_0.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 3.9 </span><span class="caption-text">Test ground motion (displacement, velocity and acceleration) given by eq. <a class="reference internal" href="#equation-h0-59">(3.60)</a> and <span class="math notranslate nohighlight">\(T_g=1\)</span> s.</span><a class="headerlink" href="#fig-test" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<div class="full-width docutils">
<p>The particular solution <span class="math notranslate nohighlight">\(z_p\)</span> solving eq. <a class="reference internal" href="#equation-h0-42">(3.43)</a> with <span class="math notranslate nohighlight">\(g=A_g\,\big[\cos(\omega_g\,t) - \cos(2\,\omega_g\,t)\big]\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-h0-61">
<span class="eqno">(3.62)<a class="headerlink" href="#equation-h0-61" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{align}
&amp; \ddot{z}_p(t) = A_g\,\big[\rho(\omega_g)\,\cos\big(\omega_g\,t+\phi(\omega_g)\big) - A(2\,\omega_g)\,\cos\big(2\,\omega_g\,t+\phi(2\,\omega_g)\big)\big]
\\
&amp; \dot{z}_p(t) = \frac{A_g}{\omega_g}\,\big[\rho(\omega_g)\,\sin\big(\omega_g\,t+\phi(\omega_g)\big) - \tfrac{1}{2}\,\sin\big(2\,\omega_g\,t+\phi(2\,\omega_g)\big)\big]
\\
&amp; z_p(t) = \frac{A_g}{\omega_g^2}\,\big[ \tfrac{1}{4}\,\rho(2\,\omega_g)\,\cos\big(2\,\omega_g\,t+\phi(2\,\omega_g)\big) -\rho(\omega_g)\,\cos\big(\omega_g\,t+\phi(\omega_g)\big)\big]
\end{align}
\end{split}\]</div>
<p>that we obtain from eqs. <a class="reference internal" href="#equation-h0-47">(3.48)</a> and  <a class="reference internal" href="#equation-h0-48">(3.49)</a> with <span class="math notranslate nohighlight">\(\phi_g=\pi/2\)</span>. At the initial, <span class="math notranslate nohighlight">\(t=0\)</span>, and end, <span class="math notranslate nohighlight">\(t=T_g\)</span>, times of the wavelet packet, the particular solution for the displacement and velocity yields</p>
<div class="math notranslate nohighlight" id="equation-h0-62">
<span class="eqno">(3.63)<a class="headerlink" href="#equation-h0-62" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{align}
&amp; \dot{z}_p(0) = \dot{z}_p(T_g) =  \frac{A_g}{\omega_g}\,\big[\rho(\omega_g)\,\sin\phi(\omega_g)- \tfrac{1}{2}\,\sin\phi(2\,\omega_g)\big]
\\
&amp; z_p(0) = z_p(T_g) = \frac{A_g}{\omega_g^2}\,\big[ \tfrac{1}{4}\,\rho(2\,\omega_g)\,\cos\phi(2\,\omega_g) -\rho(\omega_g)\,\cos\phi(\omega_g)\big]
\end{align}
\end{split}\]</div>
<p>In this respect, in order to make the relative motion due to the test ground displacement continuous at <span class="math notranslate nohighlight">\(t=0,T_g\)</span>, we write</p>
<div class="math notranslate nohighlight" id="equation-h0-63">
<span class="eqno">(3.64)<a class="headerlink" href="#equation-h0-63" title="Permalink to this equation">#</a></span>\[
z(t) = z_p(t)\,B_g(t) + z_h(t)\,H(t) - z_h(t-T_g)\,H(t-T_g)
\]</div>
<p>where <span class="math notranslate nohighlight">\(z_h\)</span> is the homogeneous obtained setting as initial conditions</p>
<div class="math notranslate nohighlight" id="equation-h0-64">
<span class="eqno">(3.65)<a class="headerlink" href="#equation-h0-64" title="Permalink to this equation">#</a></span>\[
u_0 = -z_p(0) \qquad v_0 = -\dot{z}_p(0)
\]</div>
<p>so that</p>
<div class="math notranslate nohighlight" id="equation-h0-65">
<span class="eqno">(3.66)<a class="headerlink" href="#equation-h0-65" title="Permalink to this equation">#</a></span>\[
z(0) = z(T_g) = 0 \qquad \dot{z}(0) = \dot{z}(T_g) = 0
\]</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">test_driven_oscillator</span></code> of the <code class="docutils literal notranslate"><span class="pre">theory</span></code> module implements the above equations and return the relative motion and the transient response for an harmonic oscillator driven by test ground motion</p>
</div>
<div class="cell tag_full-width tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">theory</span> <span class="kn">import</span> <span class="n">test_driven_oscillator</span>

<span class="n">help</span><span class="p">(</span><span class="n">test_driven_oscillator</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function test_driven_oscillator in module theory:

test_driven_oscillator(ts, Tg=1, natural_period=1, damping_ratio=0.1)
    
    Return the relative motion and the transient response (displacement, velocity and acceleration) of 
    an harmonic oscillator evaluated at the times ts driven by the test ground motion.
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<p>Here below, we plot the test ground and relative motions (left column) and the only steady-state and transient motions (right column)</p>
</div>
<div class="cell tag_full-width tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">relative_motions</span><span class="p">,</span> <span class="n">transient_motions</span> <span class="o">=</span> <span class="n">test_driven_oscillator</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">Tg</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="s2">&quot;row&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ground_motion</span><span class="p">,</span> <span class="n">relative_motion</span><span class="p">,</span> <span class="n">transient_motion</span><span class="p">,</span> <span class="n">ylabel</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ground_motions</span><span class="p">,</span> <span class="n">relative_motions</span><span class="p">,</span> <span class="n">transient_motions</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">):</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">ground_motion</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">relative_motion</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;relative&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">transient_motion</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;transient&quot;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<figure class="align-default" id="fig-relative-test">
<div class="cell_output docutils container">
<img alt="../_images/C0_Harmonic_62_0.png" src="../_images/C0_Harmonic_62_0.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 3.10 </span><span class="caption-text">Ground, relative and transient accelerations (blue, orange and green lines) for the driven harmonic oscillator with <span class="math notranslate nohighlight">\(T_g=1\)</span>.</span><a class="headerlink" href="#fig-relative-test" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<div class="full-width docutils">
<p>Let us now change the ground period to <span class="math notranslate nohighlight">\(T_g=2\)</span> s and make a similar plot to that shown in  <a class="reference internal" href="#fig-relative-test"><span class="std std-numref">Figure 3.10</span></a></p>
</div>
<div class="cell tag_full-width tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Tg</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">Tg</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">Tg</span><span class="p">,</span><span class="mi">10001</span><span class="p">)</span>
<span class="n">ground_motions</span> <span class="o">=</span> <span class="n">eva_test_ground_motion</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">Tg</span><span class="p">)</span>
<span class="n">relative_motions</span><span class="p">,</span> <span class="n">transient_motions</span> <span class="o">=</span> <span class="n">test_driven_oscillator</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">Tg</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="s2">&quot;row&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ground_motion</span><span class="p">,</span> <span class="n">relative_motion</span><span class="p">,</span> <span class="n">transient_motion</span><span class="p">,</span> <span class="n">ylabel</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ground_motions</span><span class="p">,</span> <span class="n">relative_motions</span><span class="p">,</span> <span class="n">transient_motions</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">):</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">ground_motion</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">relative_motion</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;relative&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">transient_motion</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;transient&quot;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<figure class="align-default" id="fig-relative-test-2">
<div class="cell_output docutils container">
<img alt="../_images/C0_Harmonic_68_0.png" src="../_images/C0_Harmonic_68_0.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 3.11 </span><span class="caption-text">Ground, relative and transient accelerations (blue, orange and green lines) for the driven harmonic oscillator with <span class="math notranslate nohighlight">\(T_g=2\)</span> s.</span><a class="headerlink" href="#fig-relative-test-2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<section id="dislocation">
<h3><a class="toc-backref" href="#id14"><span class="section-number">3.5.1. </span>Dislocation</a><a class="headerlink" href="#dislocation" title="Permalink to this headline">#</a></h3>
<div class="full-width docutils">
<p>By considering that the ground dislacement from P and S waves is proportional to the time derivative of the dislocation <span class="math notranslate nohighlight">\(\delta u\)</span>, we can obtained it by integrating the test ground displacement</p>
<div class="math notranslate nohighlight" id="equation-h0-66">
<span class="eqno">(3.67)<a class="headerlink" href="#equation-h0-66" title="Permalink to this equation">#</a></span>\[
\delta u(t) = \int_{-\infty}^t u_g(\tau)\,d \tau = \delta u_0\,\big[\tfrac{1}{12\,\pi}\,\sin(2\,\omega_g\,t)-\tfrac{2}{3\,\pi}\,\sin(\omega_g\,t) + \frac{t}{T_g}\big]\,B_{g}(t) + \delta u_0\,H(t-T_g)
\]</div>
<p>that we show here in the case of the ground period set to <span class="math notranslate nohighlight">\(T_g=3\)</span> s</p>
</div>
<div class="cell tag_full-width tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Tg</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">Tg</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mf">1.5</span><span class="o">*</span><span class="n">Tg</span><span class="p">,</span><span class="mi">10001</span><span class="p">)</span>

<span class="n">wg</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">Tg</span>
<span class="n">dislocation</span> <span class="o">=</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">wg</span><span class="o">*</span><span class="n">ts</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">wg</span><span class="o">*</span><span class="n">ts</span><span class="p">)</span> <span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">+</span> <span class="n">ts</span><span class="o">/</span><span class="n">Tg</span>
<span class="n">dislocation</span><span class="p">[</span><span class="n">ts</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">dislocation</span><span class="p">[</span><span class="n">ts</span><span class="o">&gt;</span><span class="n">Tg</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">dislocation</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Tg</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="full-width docutils">
<figure class="align-default" id="fig-dislocation">
<div class="cell_output docutils container">
<img alt="../_images/C0_Harmonic_74_0.png" src="../_images/C0_Harmonic_74_0.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 3.12 </span><span class="caption-text">Time evolution of the dislocation over the fault.</span><a class="headerlink" href="#fig-dislocation" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<p style="page-break-after:always;"></p></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./files"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="A1_Tutorial.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">2. </span>Tutorial on Python</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="C1_Fourier.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Fourier transform</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By <a href="https://sites.unimi.it/gcambiotti/">Gabriele Cambiotti</a><br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>